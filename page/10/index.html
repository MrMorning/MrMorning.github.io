<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"mrmorning.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Chen Geng&#39;s Blog">
<meta property="og:url" content="mrmorning.github.io/page/10/index.html">
<meta property="og:site_name" content="Chen Geng&#39;s Blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Chen Geng">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="mrmorning.github.io/page/10/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Chen Geng's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Chen Geng's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="mrmorning.github.io/2017/02/23/bzoj2186-Sdoi2008-%E6%B2%99%E6%8B%89%E5%85%AC%E4%B8%BB%E7%9A%84%E5%9B%B0%E6%83%91%E2%80%94%E2%80%94%E6%95%B0%E8%AE%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Geng">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chen Geng's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/23/bzoj2186-Sdoi2008-%E6%B2%99%E6%8B%89%E5%85%AC%E4%B8%BB%E7%9A%84%E5%9B%B0%E6%83%91%E2%80%94%E2%80%94%E6%95%B0%E8%AE%BA/" class="post-title-link" itemprop="url">[bzoj2186][Sdoi2008]沙拉公主的困惑——数论</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-02-23 08:08:00" itemprop="dateCreated datePublished" datetime="2017-02-23T08:08:00+00:00">2017-02-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-02 09:03:59" itemprop="dateModified" datetime="2020-08-02T09:03:59+00:00">2020-08-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>#题目大意<br>求<br>$$\sum_{i = 1}^{N!} [gcd(i, M!) = 1]$$<br>#题解<br>显然，题目就是求<br>$$N!(1-\frac{1}{p_1})(1-\frac{1}{p_2})…$$<br>即<br>$$N!\prod(p_i - 1)(\prod p_i)^{-1}$$<br>预处理一下，都是线性复杂度。<br>注意：<br>1. N=1的情况<br>2. long long</p>
<p><strong>所以，数论题一定要注意各种特殊情况和longlong</strong></p>
<p>#代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line">#define ll long long</span><br><span class="line">using namespace std;</span><br><span class="line">const int maxn &#x3D; 10000110;</span><br><span class="line">const int N &#x3D; 10000010;</span><br><span class="line">int n, m, t, r;</span><br><span class="line">int prime[maxn], check[maxn], d[maxn];</span><br><span class="line">int prd1[maxn], prd2[maxn], fact[maxn];</span><br><span class="line">int tot &#x3D; 0;</span><br><span class="line"></span><br><span class="line">inline int read() &#123;</span><br><span class="line">  char c &#x3D; getchar();</span><br><span class="line">  int f &#x3D; 1, x &#x3D; 0;</span><br><span class="line">  while (!isdigit(c)) &#123;</span><br><span class="line">    if (c &#x3D;&#x3D; &#39;-&#39;)</span><br><span class="line">      f &#x3D; -1;</span><br><span class="line">    c &#x3D; getchar();</span><br><span class="line">  &#125;</span><br><span class="line">  while (isdigit(c))</span><br><span class="line">    x &#x3D; x * 10 + c - &#39;0&#39;, c &#x3D; getchar();</span><br><span class="line">  return x * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">inline void get_prime(int n) &#123;</span><br><span class="line">  memset(check, 0, sizeof(check));</span><br><span class="line">  for (int i &#x3D; 2; i &lt;&#x3D; n; i++) &#123;</span><br><span class="line">    if (!check[i])</span><br><span class="line">      prime[tot++] &#x3D; i;</span><br><span class="line">    for (int j &#x3D; 0; j &lt; tot; j++) &#123;</span><br><span class="line">      if (i * prime[j] &gt; n)</span><br><span class="line">        break;</span><br><span class="line">      check[i * prime[j]] &#x3D; 1;</span><br><span class="line">      if (i % prime[j] &#x3D;&#x3D; 0)</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">inline void get_prd(int p) &#123;</span><br><span class="line">  &#x2F;&#x2F; get prd (p_i - 1) and prd (p_i);</span><br><span class="line">  prd1[0] &#x3D; 1;</span><br><span class="line">  prd2[0] &#x3D; 2;</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; tot; i++) &#123;</span><br><span class="line">    prd1[i] &#x3D; (((ll)prime[i] - 1) % p * (ll)prd1[i - 1]) % p;</span><br><span class="line">    prd2[i] &#x3D; (ll)(prime[i] % p * (ll)prd2[i - 1]) % p;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">inline void init() &#123;</span><br><span class="line"></span><br><span class="line">  for (int i &#x3D; 0; i &lt; tot; i++) &#123;</span><br><span class="line">    for (int j &#x3D; prime[i]; j &lt; prime[i + 1]; j++)</span><br><span class="line">      d[j] &#x3D; i;</span><br><span class="line">  &#125;</span><br><span class="line">  fact[0] &#x3D; fact[1] &#x3D; 1;</span><br><span class="line">  for (int i &#x3D; 2; i &lt;&#x3D; N; i++)</span><br><span class="line">    fact[i] &#x3D; (ll)(fact[i - 1] * (ll)i) % r;</span><br><span class="line">&#125;</span><br><span class="line">int pow(int a, int b, int p) &#123;</span><br><span class="line">  int x &#x3D; 1;</span><br><span class="line">  int c &#x3D; b;</span><br><span class="line">  while (c) &#123;</span><br><span class="line">    if (c &amp; 1)</span><br><span class="line">      x &#x3D; (ll)((ll)x * a) % p;</span><br><span class="line">    a &#x3D; (ll)((ll)a * a) % p;</span><br><span class="line">    c &gt;&gt;&#x3D; 1;</span><br><span class="line">  &#125;</span><br><span class="line">  return x;</span><br><span class="line">&#125;</span><br><span class="line">int inv(int a, int p) &#123; return pow(a, p - 2, p); &#125;</span><br><span class="line">int main() &#123;</span><br><span class="line">  scanf(&quot;%lld %lld&quot;, &amp;t, &amp;r);</span><br><span class="line">  get_prime(N);</span><br><span class="line">  get_prd(r);</span><br><span class="line">  init();</span><br><span class="line">  while (t--) &#123;</span><br><span class="line">    n &#x3D; read();</span><br><span class="line">    m &#x3D; read();</span><br><span class="line">    if (m &#x3D;&#x3D; 1) &#123;</span><br><span class="line">      printf(&quot;%lld\n&quot;, fact[n]);</span><br><span class="line">      continue;</span><br><span class="line">    &#125;</span><br><span class="line">    int ans &#x3D; ((ll)((ll)fact[n] * prd1[d[m]]) % r * (ll)inv(prd2[d[m]], r)) % r;</span><br><span class="line">    printf(&quot;%d\n&quot;, ans);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="mrmorning.github.io/2017/02/22/bzoj2427-HAOI2010-%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85%E2%80%94%E2%80%94%E5%BC%BA%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F-%E6%A0%91%E5%BD%A2DP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Geng">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chen Geng's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/22/bzoj2427-HAOI2010-%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85%E2%80%94%E2%80%94%E5%BC%BA%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F-%E6%A0%91%E5%BD%A2DP/" class="post-title-link" itemprop="url">[bzoj2427][HAOI2010]软件安装——强连通分量+树形DP</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-02-22 17:50:00" itemprop="dateCreated datePublished" datetime="2017-02-22T17:50:00+00:00">2017-02-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-02 09:03:59" itemprop="dateModified" datetime="2020-08-02T09:03:59+00:00">2020-08-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="题目大意"><a href="#题目大意" class="headerlink" title="题目大意"></a>题目大意</h1><p>现在我们的手头有N个软件，对于一个软件i，它要占用Wi的磁盘空间，它的价值为Vi。我们希望从中选择一些软件安装到一台磁盘容量为M计算机上，使得这些软件的价值尽可能大（即Vi的和最大）。</p>
<p>但是现在有个问题：软件之间存在依赖关系，即软件i只有在安装了软件j（包括软件j的直接或间接依赖）的情况下才能正确工作（软件i依赖软件j)。幸运的是，一个软件最多依赖另外一个软件。如果一个软件不能正常工作，那么它能够发挥的作用为0。</p>
<p>我们现在知道了软件之间的依赖关系：软件i依赖软件Di。现在请你设计出一种方案，安装价值尽量大的软件。一个软件只能被安装一次，如果一个软件没有依赖则Di=0，这时只要这个软件安装了，它就能正常工作。</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>根据题目，我们建立图。<br>显然这个图由一些树和一些scc构成（注意：scc一定不在树上），那么我们可以知道，如果选了scc中的一个点，其他点必须也要选，所以我们把所有的scc缩成一个点，这样就构成了一个森林。<br>对于一个入度为0的点，我们从一个虚点向其连接一条边，这样图就变成了树。<br>考虑树形dp，定义f[i][j]为对于i为根的子树总共分配j点权值能拿到的最大value<br>我们可以有$$f[i][j] = f[k][l] + f[i][j-l]$$<br>记忆化搜索即可。</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> ll maxn = <span class="number">505</span>;</span><br><span class="line"><span class="keyword">const</span> ll maxm = <span class="number">1000</span>;</span><br><span class="line">ll n, m, K, s, ans = <span class="number">0</span>;</span><br><span class="line">ll w[maxn], v[maxn], W[maxn], V[maxn];</span><br><span class="line">ll cnt[maxn], vis[maxn], in[maxn], f[maxn][maxm];</span><br><span class="line"><span class="built_in">vector</span>&lt;ll&gt; sc[maxn];</span><br><span class="line"><span class="built_in">vector</span>&lt;ll&gt; vs;</span><br><span class="line"><span class="built_in">vector</span>&lt;ll&gt; G[maxn];</span><br><span class="line"><span class="built_in">vector</span>&lt;ll&gt; rg[maxn];</span><br><span class="line"><span class="built_in">vector</span>&lt;ll&gt; ng[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(ll from, ll to)</span> </span>&#123;</span><br><span class="line">  G[from].push_back(to);</span><br><span class="line">  rg[to].push_back(from);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_edge</span><span class="params">(ll from, ll to)</span> </span>&#123;</span><br><span class="line">  in[to] = <span class="number">1</span>;</span><br><span class="line">  ng[from].push_back(to);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(ll s)</span> </span>&#123;</span><br><span class="line">  vis[s] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (ll i = <span class="number">0</span>; i &lt; G[s].size(); i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!vis[G[s][i]])</span><br><span class="line">      dfs(G[s][i]);</span><br><span class="line">  &#125;</span><br><span class="line">  vs.push_back(s);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rdfs</span><span class="params">(ll s, ll k)</span> </span>&#123;</span><br><span class="line">  vis[s] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (ll i = <span class="number">0</span>; i &lt; rg[s].size(); i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!vis[rg[s][i]])</span><br><span class="line">      rdfs(rg[s][i], k);</span><br><span class="line">  &#125;</span><br><span class="line">  cnt[s] = k;</span><br><span class="line">  sc[k].push_back(s);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">scc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis));</span><br><span class="line">  vs.clear();</span><br><span class="line">  <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!vis[i])</span><br><span class="line">      dfs(i);</span><br><span class="line">  &#125;</span><br><span class="line">  ll k = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis));</span><br><span class="line">  <span class="keyword">for</span> (ll i = vs.size() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!vis[vs[i]])</span><br><span class="line">      rdfs(vs[i], k++);</span><br><span class="line">  &#125;</span><br><span class="line">  K = k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build_graph</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (ll i = <span class="number">0</span>; i &lt; K; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (ll j = <span class="number">0</span>; j &lt; sc[i].size(); j++) &#123;</span><br><span class="line">      W[i] += w[sc[i][j]];</span><br><span class="line">      V[i] += v[sc[i][j]];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (ll j = <span class="number">0</span>; j &lt; G[i].size(); j++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (cnt[i] != cnt[G[i][j]])</span><br><span class="line">        add_edge(cnt[i], cnt[G[i][j]]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  s = K + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (ll i = <span class="number">0</span>; i &lt; K; i++)</span><br><span class="line">    <span class="keyword">if</span> (!in[i])</span><br><span class="line">      add_edge(s, i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (ll i = <span class="number">0</span>; i &lt; ng[x].size(); i++) &#123;</span><br><span class="line">    dp(ng[x][i]);</span><br><span class="line">    <span class="keyword">for</span> (ll j = m - W[x]; j &gt;= <span class="number">0</span>; j--) &#123; <span class="comment">//鏋氫妇閫夊畬鑷繁鍚庤垂鐢?</span></span><br><span class="line">      <span class="keyword">for</span> (ll k = <span class="number">0</span>; k &lt;= j; k++) &#123;      <span class="comment">//鏋氫妇缁欏効瀛愮殑璐圭敤</span></span><br><span class="line">        f[x][j] = max(f[x][j], f[x][k] + f[ng[x][i]][j - k]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (ll j = m; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">    <span class="keyword">if</span> (j &gt;= W[x])</span><br><span class="line">      f[x][j] = f[x][j - W[x]] + V[x];</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      f[x][j] = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// freopen(&quot;input&quot;, &quot;r&quot;, stdin);</span></span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%lld %lld&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;w[i]);</span><br><span class="line">  <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;v[i]);</span><br><span class="line">  <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    ll x;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;x);</span><br><span class="line">    <span class="keyword">if</span> (x)</span><br><span class="line">      add(x, i);</span><br><span class="line">  &#125;</span><br><span class="line">  scc();</span><br><span class="line">  build_graph();</span><br><span class="line">  dp(s);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, f[s][m]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="mrmorning.github.io/2017/02/22/bzoj3931-CQOI2015-%E7%BD%91%E7%BB%9C%E5%90%9E%E5%90%90%E9%87%8F%E2%80%94%E2%80%94%E6%9C%80%E7%9F%AD%E8%B7%AF-%E7%BD%91%E7%BB%9C%E6%B5%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Geng">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chen Geng's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/22/bzoj3931-CQOI2015-%E7%BD%91%E7%BB%9C%E5%90%9E%E5%90%90%E9%87%8F%E2%80%94%E2%80%94%E6%9C%80%E7%9F%AD%E8%B7%AF-%E7%BD%91%E7%BB%9C%E6%B5%81/" class="post-title-link" itemprop="url">[bzoj3931][CQOI2015]网络吞吐量——最短路+网络流</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-02-22 15:07:00" itemprop="dateCreated datePublished" datetime="2017-02-22T15:07:00+00:00">2017-02-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-02 09:03:59" itemprop="dateModified" datetime="2020-08-02T09:03:59+00:00">2020-08-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>#题目<br><a target="_blank" rel="noopener" href="http://www.lydsy.com/JudgeOnline/problem.php?id=3931">传送门</a><br>#题解<br>第一次一遍就AC一道bzoj上的题，虽然是一道水题。。。<br>我们做一边最短路，求出每个点的dist，然后再做一次类似spfa的操作，求出每个点是否可以用于建图。<br>在新图上拆点跑一边dinic就好辣。<br>#代码</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">const</span> ll inf = <span class="number">100000000000</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1000</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> from;</span><br><span class="line">  <span class="keyword">int</span> to;</span><br><span class="line">  ll value;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;edge&gt; edges;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[maxn];</span><br><span class="line"><span class="built_in">vector</span>&lt;edge&gt; gg[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> from, <span class="keyword">int</span> to, ll value)</span> </span>&#123;</span><br><span class="line">  gg[from].push_back((edge)&#123;from, to, value&#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_edge</span><span class="params">(<span class="keyword">int</span> from, <span class="keyword">int</span> to, ll value)</span> </span>&#123;</span><br><span class="line">  edges.push_back((edge)&#123;from, to, value&#125;);</span><br><span class="line">  edges.push_back((edge)&#123;to, from, <span class="number">0</span>&#125;);</span><br><span class="line">  <span class="keyword">int</span> m = edges.size();</span><br><span class="line">  G[from].push_back(m - <span class="number">2</span>);</span><br><span class="line">  G[to].push_back(m - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">ll dist[maxn];</span><br><span class="line"><span class="keyword">int</span> iter[maxn];</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line">ll c[maxn];</span><br><span class="line"><span class="keyword">int</span> st, t;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> s)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    dist[i] = inf;</span><br><span class="line">  <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">  <span class="keyword">bool</span> inq[maxn];</span><br><span class="line">  <span class="built_in">memset</span>(inq, <span class="number">0</span>, <span class="keyword">sizeof</span>(inq));</span><br><span class="line">  q.push(s);</span><br><span class="line">  dist[s] = <span class="number">0</span>;</span><br><span class="line">  inq[s] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">    <span class="keyword">int</span> u = q.front();</span><br><span class="line">    q.pop();</span><br><span class="line">    inq[u] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; gg[u].size(); i++) &#123;</span><br><span class="line">      edge &amp;e = gg[u][i];</span><br><span class="line">      <span class="keyword">if</span> (dist[e.to] &gt; dist[u] + e.value) &#123;</span><br><span class="line">        dist[e.to] = dist[u] + e.value;</span><br><span class="line">        <span class="keyword">if</span> (!inq[e.to]) &#123;</span><br><span class="line">          q.push(e.to);</span><br><span class="line">          inq[e.to] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build_graph</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> e)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">  q.push(s);</span><br><span class="line">  <span class="keyword">bool</span> inq[maxn];</span><br><span class="line">  <span class="built_in">memset</span>(inq, <span class="number">0</span>, <span class="keyword">sizeof</span>(inq));</span><br><span class="line">  inq[s] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">int</span> vis[maxn];</span><br><span class="line">  <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis));</span><br><span class="line">  vis[s] = <span class="number">1</span>;</span><br><span class="line">  add_edge(st, s, inf);</span><br><span class="line">  add_edge(e + n, t, inf);</span><br><span class="line">  add_edge(s, s + n, inf);</span><br><span class="line">  add_edge(e, e + n, inf);</span><br><span class="line">  <span class="keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">    <span class="keyword">int</span> u = q.front();</span><br><span class="line">    q.pop();</span><br><span class="line">    inq[u] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; gg[u].size(); i++) &#123;</span><br><span class="line">      edge &amp;ee = gg[u][i];</span><br><span class="line">      <span class="keyword">if</span> (dist[ee.to] == dist[u] + ee.value) &#123;</span><br><span class="line"></span><br><span class="line">        add_edge(u + n, ee.to, inf);</span><br><span class="line">        <span class="keyword">if</span> (!vis[ee.to] &amp;&amp; ee.to != e) &#123;</span><br><span class="line">          add_edge(ee.to, ee.to + n, c[ee.to]);</span><br><span class="line">          vis[ee.to] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!inq[ee.to]) &#123;</span><br><span class="line">          q.push(ee.to);</span><br><span class="line">          inq[ee.to] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">(<span class="keyword">int</span> s)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">memset</span>(dist, <span class="number">-1</span>, <span class="keyword">sizeof</span>(dist));</span><br><span class="line">  dist[s] = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">  q.push(s);</span><br><span class="line">  <span class="keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">    <span class="keyword">int</span> u = q.front();</span><br><span class="line">    q.pop();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[u].size(); i++) &#123;</span><br><span class="line">      edge &amp;e = edges[G[u][i]];</span><br><span class="line">      <span class="keyword">if</span> (e.value &gt; <span class="number">0</span> &amp;&amp; dist[e.to] == <span class="number">-1</span>) &#123;</span><br><span class="line">        dist[e.to] = dist[u] + <span class="number">1</span>;</span><br><span class="line">        q.push(e.to);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t, ll flow)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (s == t)</span><br><span class="line">    <span class="keyword">return</span> flow;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> &amp;i = iter[s]; i &lt; G[s].size(); i++) &#123;</span><br><span class="line">    edge &amp;e = edges[G[s][i]];</span><br><span class="line">    <span class="keyword">if</span> (dist[e.to] &gt; dist[s] &amp;&amp; e.value &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">int</span> d = dfs(e.to, t, min(flow, e.value));</span><br><span class="line">      <span class="keyword">if</span> (d &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        e.value -= d;</span><br><span class="line">        edges[G[s][i] ^ <span class="number">1</span>].value += d;</span><br><span class="line">        <span class="keyword">return</span> d;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">dinic</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">  ll flow = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">    bfs(s);</span><br><span class="line">    <span class="keyword">if</span> (dist[t] == <span class="number">-1</span>)</span><br><span class="line">      <span class="keyword">return</span> flow;</span><br><span class="line">    <span class="built_in">memset</span>(iter, <span class="number">0</span>, <span class="keyword">sizeof</span>(iter));</span><br><span class="line">    ll d;</span><br><span class="line">    <span class="keyword">while</span> (d = dfs(s, t, inf))</span><br><span class="line">      flow += d;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">//  freopen(&quot;input&quot;, &quot;r&quot;, stdin);</span></span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line">    ll z;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %lld&quot;</span>, &amp;x, &amp;y, &amp;z);</span><br><span class="line">    add(x, y, z);</span><br><span class="line">    add(y, x, z);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;c[i]);</span><br><span class="line">  spfa(<span class="number">1</span>);</span><br><span class="line">  st = <span class="number">0</span>, t = n + n + <span class="number">1</span>;</span><br><span class="line">  build_graph(<span class="number">1</span>, n);</span><br><span class="line"></span><br><span class="line">  ll ans = dinic(st, t);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Excited！</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="mrmorning.github.io/2017/02/22/bzoj1823-JSOI2010-%E6%BB%A1%E6%B1%89%E5%85%A8%E5%B8%AD%E2%80%94%E2%80%942-SAT/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Geng">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chen Geng's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/22/bzoj1823-JSOI2010-%E6%BB%A1%E6%B1%89%E5%85%A8%E5%B8%AD%E2%80%94%E2%80%942-SAT/" class="post-title-link" itemprop="url">[bzoj1823][JSOI2010]满汉全席——2-SAT</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-02-22 11:53:00" itemprop="dateCreated datePublished" datetime="2017-02-22T11:53:00+00:00">2017-02-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-02 09:03:59" itemprop="dateModified" datetime="2020-08-02T09:03:59+00:00">2020-08-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="题目大意"><a href="#题目大意" class="headerlink" title="题目大意"></a>题目大意</h1><p>题目又丑又长我就不贴了，说一下大意，有n种菜，m个评委，每一个评委又有两种喜好，每种菜有满汉两种做法，只能选一种。判断是否存在一种方案使得所有评委至少喜欢一种菜品。输入包含多组数据。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2017/02/22/bzoj1823-JSOI2010-%E6%BB%A1%E6%B1%89%E5%85%A8%E5%B8%AD%E2%80%94%E2%80%942-SAT/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="mrmorning.github.io/2017/02/22/bzoj1486-HNOI2009-%E6%9C%80%E5%B0%8F%E5%9C%88%E2%80%94%E2%80%94%E5%88%86%E6%95%B0%E8%A7%84%E5%88%92-spfa-%E8%B4%9F%E7%8E%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Geng">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chen Geng's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/22/bzoj1486-HNOI2009-%E6%9C%80%E5%B0%8F%E5%9C%88%E2%80%94%E2%80%94%E5%88%86%E6%95%B0%E8%A7%84%E5%88%92-spfa-%E8%B4%9F%E7%8E%AF/" class="post-title-link" itemprop="url">[bzoj1486][HNOI2009]最小圈——分数规划+spfa+负环</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-02-22 09:32:00" itemprop="dateCreated datePublished" datetime="2017-02-22T09:32:00+00:00">2017-02-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-02 09:03:59" itemprop="dateModified" datetime="2020-08-02T09:03:59+00:00">2020-08-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>#题目<br><a target="_blank" rel="noopener" href="http://www.lydsy.com/JudgeOnline/problem.php?id=1486">传送门</a><br>#题解<br>这个题是一个经典的分数规划问题。<br>把题目形式化地表示，就是<br>$$Minimize\ \lambda = \frac{\sum W_{i, i+1}}{k}$$<br>整理一下，就是<br>$$\lambda * k = \sum W_{i, i+1}$$<br>定义新的函数<br>$$g(\lambda) = Min(\lambda * k - \sum W_{i, i+1})$$<br>显然这个函数单调，我们二分$\lambda$，等价于求一个负环。<br>如果用spfa求负环会Tle，所以学习了用dfs求负环，如代码所示。<br>#代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">const int maxn &#x3D; 3005 * 2;</span><br><span class="line">#define exp 1e-10</span><br><span class="line">const double inf &#x3D; 1000000000;</span><br><span class="line">int n, m;</span><br><span class="line">struct edge &#123;</span><br><span class="line">  int to;</span><br><span class="line">  double value;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;edge&gt; G[maxn];</span><br><span class="line">vector&lt;edge&gt; rg[maxn];</span><br><span class="line">int vis[maxn];</span><br><span class="line">int flag;</span><br><span class="line">double dist[maxn];</span><br><span class="line">inline void spfa(int x) &#123;</span><br><span class="line">  int i;</span><br><span class="line">  vis[x] &#x3D; false;</span><br><span class="line">  for (i &#x3D; 0; i &lt; rg[x].size(); i++) &#123;</span><br><span class="line">    edge &amp;e &#x3D; rg[x][i];</span><br><span class="line">    if (dist[e.to] &gt; dist[x] + e.value)</span><br><span class="line">      if (!vis[e.to]) &#123;</span><br><span class="line">        flag &#x3D; true;</span><br><span class="line">        break;</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        dist[e.to] &#x3D; dist[x] + e.value;</span><br><span class="line">        spfa(e.to);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  vis[x] &#x3D; true;</span><br><span class="line">&#125;</span><br><span class="line">bool check(double lambda) &#123;</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; n; i++) &#123;</span><br><span class="line">    rg[i].clear();</span><br><span class="line">    for (int j &#x3D; 0; j &lt; G[i].size(); j++) &#123;</span><br><span class="line">      rg[i].push_back((edge)&#123;G[i][j].to, (double)G[i][j].value - lambda&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  memset(vis, 1, sizeof(vis));</span><br><span class="line">  memset(dist, 0, sizeof(dist));</span><br><span class="line">  flag &#x3D; false;</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; n; i++) &#123;</span><br><span class="line">    spfa(i);</span><br><span class="line">    if (flag)</span><br><span class="line">      return true;</span><br><span class="line">  &#125;</span><br><span class="line">  return false;</span><br><span class="line">&#125;</span><br><span class="line">int main() &#123;</span><br><span class="line">  &#x2F;&#x2F; freopen(&quot;input&quot;, &quot;r&quot;, stdin);</span><br><span class="line">  scanf(&quot;%d %d&quot;, &amp;n, &amp;m);</span><br><span class="line">  int tot &#x3D; 0;</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; m; i++) &#123;</span><br><span class="line">    int x, y;</span><br><span class="line">    double z;</span><br><span class="line">    scanf(&quot;%d %d %lf&quot;, &amp;x, &amp;y, &amp;z);</span><br><span class="line">    G[x].push_back((edge)&#123;y, z&#125;);</span><br><span class="line">    tot +&#x3D; z;</span><br><span class="line">  &#125;</span><br><span class="line">  double l &#x3D; -inf, r &#x3D; inf;</span><br><span class="line">  while (l + exp &lt; r) &#123;</span><br><span class="line">    double mid &#x3D; (l + r) &#x2F; 2;</span><br><span class="line">    if (check(mid))</span><br><span class="line">      r &#x3D; mid;</span><br><span class="line">    else</span><br><span class="line">      l &#x3D; mid;</span><br><span class="line">  &#125;</span><br><span class="line">  printf(&quot;%.8f&quot;, l);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="mrmorning.github.io/2017/02/21/bzoj3532-Sdoi2014-Lis%E2%80%94%E2%80%94%E6%8B%86%E7%82%B9%E6%9C%80%E5%B0%8F%E5%89%B2-%E5%AD%97%E5%85%B8%E5%BA%8F-%E9%80%80%E6%B5%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Geng">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chen Geng's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/21/bzoj3532-Sdoi2014-Lis%E2%80%94%E2%80%94%E6%8B%86%E7%82%B9%E6%9C%80%E5%B0%8F%E5%89%B2-%E5%AD%97%E5%85%B8%E5%BA%8F-%E9%80%80%E6%B5%81/" class="post-title-link" itemprop="url">[bzoj3532][Sdoi2014]Lis——拆点最小割+字典序+退流</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-02-21 18:01:00" itemprop="dateCreated datePublished" datetime="2017-02-21T18:01:00+00:00">2017-02-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-02 09:03:59" itemprop="dateModified" datetime="2020-08-02T09:03:59+00:00">2020-08-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="题目大意"><a href="#题目大意" class="headerlink" title="题目大意"></a>题目大意</h1><p> 给定序列A，序列中的每一项Ai有删除代价Bi和附加属性Ci。请删除若<br>干项，使得4的最长上升子序列长度减少至少1，且付出的代价之和最小，并输出方案。<br>    如果有多种方案，请输出将删去项的附加属性排序之后，字典序最小的一种。</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>首先我们很容易用一个$\Theta (n^2)$的算法求出对于每个元素的lis。<br>考虑以下的建图方式：<br>由S向f[i]==1的点连边，容量为$\infty$，<br>由f[i] = max 向 T 连边， 容量为$\infty$,<br>对于每个点，拆为两个点，费用就是B[i]。<br>为什么这样建图是对的？原因很简单，原问题等价于在新图中找一个点集，使得s到t不再连通，这让我们联想到最小割，考虑到s，t到每个点不计入费用，所以我们设为$\infty$。<br>那么第一个问题解决了，关键是第二个问题：怎样找出字典序最小的割？<br>我们这样考虑：既然是字典序最小，我们把C[i]从小到大排序，依次检查每一条边，如果在剩余网络中它不连通，那么这条边一定是原图的一个最小割，我们把这条边删除，同时从汇点开始退流。具体的，我们可以从汇点向v跑一次最大流，u向原点跑一次最大流，这样一定会退回一些流，使得这条边的影响消失。<br>这样我们就解决了这个问题，详细过程见（我写了4个小时的）代码。</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">const int maxn &#x3D; 10000;</span><br><span class="line">int A[maxn], B[maxn], C[maxn], f[maxn];</span><br><span class="line">int n, s, t, v;</span><br><span class="line">const int inf &#x3D; 1000000010;</span><br><span class="line">struct edge &#123;</span><br><span class="line">  int from;</span><br><span class="line">  int to;</span><br><span class="line">  int cap;</span><br><span class="line">&#125;;</span><br><span class="line">struct haha &#123;</span><br><span class="line">  int id;</span><br><span class="line">  int Ci;</span><br><span class="line">&#125; cc[maxn];</span><br><span class="line"></span><br><span class="line">inline int read() &#123;</span><br><span class="line">  char c &#x3D; getchar();</span><br><span class="line">  int f &#x3D; 1, x &#x3D; 0;</span><br><span class="line">  while (!isdigit(c)) &#123;</span><br><span class="line">    if (c &#x3D;&#x3D; &#39;-&#39;)</span><br><span class="line">      f &#x3D; -1;</span><br><span class="line">    c &#x3D; getchar();</span><br><span class="line">  &#125;</span><br><span class="line">  while (isdigit(c))</span><br><span class="line">    x &#x3D; x * 10 + c - &#39;0&#39;, c &#x3D; getchar();</span><br><span class="line">  return x * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">bool cmp(haha a, haha b) &#123; return a.Ci &lt; b.Ci; &#125;</span><br><span class="line"></span><br><span class="line">vector&lt;edge&gt; edges;</span><br><span class="line">vector&lt;int&gt; G[maxn];</span><br><span class="line">inline void add_edge(int from, int to, int cap) &#123;</span><br><span class="line">  edges.push_back((edge)&#123;from, to, cap&#125;);</span><br><span class="line">  edges.push_back((edge)&#123;to, from, 0&#125;);</span><br><span class="line">  int m &#x3D; edges.size();</span><br><span class="line">  G[from].push_back(m - 2);</span><br><span class="line">  G[to].push_back(m - 1);</span><br><span class="line">&#125;</span><br><span class="line">inline void reaad() &#123;</span><br><span class="line">  scanf(&quot;%d&quot;, &amp;n);</span><br><span class="line">  s &#x3D; 0, t &#x3D; 2 * n + 1, v &#x3D; t + 1;</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; n; i++) &#123;</span><br><span class="line">    A[i] &#x3D; read();</span><br><span class="line">  &#125;</span><br><span class="line">  for (int i &#x3D; 0; i &lt; v; i++)</span><br><span class="line">    G[i].clear();</span><br><span class="line">  edges.clear();</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; n; i++)</span><br><span class="line">    B[i] &#x3D; read();</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; n; i++) &#123;</span><br><span class="line">    C[i] &#x3D; read();</span><br><span class="line">    cc[i].id &#x3D; i;</span><br><span class="line">    cc[i].Ci &#x3D; C[i];</span><br><span class="line">  &#125;</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; n; i++)</span><br><span class="line">    add_edge(i, i + n, B[i]);</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; n; i++)</span><br><span class="line">    f[i] &#x3D; 1;</span><br><span class="line">  int ans &#x3D; 0;</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; n; i++) &#123;</span><br><span class="line">    for (int j &#x3D; 1; j &lt; i; j++) &#123;</span><br><span class="line">      if (A[j] &lt; A[i])</span><br><span class="line">        f[i] &#x3D; max(f[i], f[j] + 1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ans &#x3D; max(ans, f[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; n; i++) &#123;</span><br><span class="line">    if (ans &#x3D;&#x3D; f[i]) &#123;</span><br><span class="line">      add_edge(i + n, t, inf);</span><br><span class="line">    &#125;</span><br><span class="line">    if (f[i] &#x3D;&#x3D; 1)</span><br><span class="line">      add_edge(s, i, inf);</span><br><span class="line">    for (int j &#x3D; 1; j &lt;&#x3D; n; j++) &#123;</span><br><span class="line">      if (A[j] &lt; A[i] &amp;&amp; j &lt; i &amp;&amp; f[i] &#x3D;&#x3D; f[j] + 1)</span><br><span class="line">        add_edge(j + n, i, inf);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">int dist[maxn], iter[maxn];</span><br><span class="line">inline void bfs(int s) &#123;</span><br><span class="line">  memset(dist, -1, sizeof(dist));</span><br><span class="line">  dist[s] &#x3D; 0;</span><br><span class="line">  queue&lt;int&gt; q;</span><br><span class="line">  q.push(s);</span><br><span class="line">  while (!q.empty()) &#123;</span><br><span class="line">    int u &#x3D; q.front();</span><br><span class="line">    q.pop();</span><br><span class="line">    for (int i &#x3D; 0; i &lt; G[u].size(); i++) &#123;</span><br><span class="line">      edge &amp;e &#x3D; edges[G[u][i]];</span><br><span class="line">      if (e.cap &gt; 0 &amp;&amp; dist[e.to] &#x3D;&#x3D; -1) &#123;</span><br><span class="line">        dist[e.to] &#x3D; dist[u] + 1;</span><br><span class="line">        q.push(e.to);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">inline int dfs(int s, int t, int flow) &#123;</span><br><span class="line">  if (s &#x3D;&#x3D; t)</span><br><span class="line">    return flow;</span><br><span class="line">  for (int &amp;i &#x3D; iter[s]; i &lt; G[s].size(); i++) &#123;</span><br><span class="line">    edge &amp;e &#x3D; edges[G[s][i]];</span><br><span class="line">    if (e.cap &gt; 0 &amp;&amp; dist[e.to] &gt; dist[s]) &#123;</span><br><span class="line">      int d &#x3D; dfs(e.to, t, min(e.cap, flow));</span><br><span class="line">      if (d &gt; 0) &#123;</span><br><span class="line">        e.cap -&#x3D; d;</span><br><span class="line">        edges[G[s][i] ^ 1].cap +&#x3D; d;</span><br><span class="line">        return d;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br><span class="line">inline int dinic(int s, int t) &#123;</span><br><span class="line">  int flow &#x3D; 0;</span><br><span class="line">  while (1) &#123;</span><br><span class="line">    bfs(s);</span><br><span class="line">    if (dist[t] &#x3D;&#x3D; -1)</span><br><span class="line">      return flow;</span><br><span class="line">    memset(iter, 0, sizeof(iter));</span><br><span class="line">    int d;</span><br><span class="line">    while (d &#x3D; dfs(s, t, inf))</span><br><span class="line">      flow +&#x3D; d;</span><br><span class="line">  &#125;</span><br><span class="line">  return flow;</span><br><span class="line">&#125;</span><br><span class="line">int main() &#123;</span><br><span class="line">  &#x2F;&#x2F; freopen(&quot;input&quot;, &quot;r&quot;, stdin);</span><br><span class="line">  int T;</span><br><span class="line">  scanf(&quot;%d&quot;, &amp;T);</span><br><span class="line">  while (T--) &#123;</span><br><span class="line">    reaad();</span><br><span class="line">    int ans &#x3D; dinic(s, t);</span><br><span class="line">    int tot &#x3D; 0;</span><br><span class="line">    int rec[maxn];</span><br><span class="line">    memset(rec, 0, sizeof(rec));</span><br><span class="line">    sort(cc + 1, cc + 1 + n, cmp);</span><br><span class="line">    for (int i &#x3D; 1; i &lt;&#x3D; n; i++) &#123;</span><br><span class="line">      int now &#x3D; cc[i].id;</span><br><span class="line">      int u &#x3D; now, v &#x3D; now + n;</span><br><span class="line">      bfs(u);</span><br><span class="line">      if (dist[v] !&#x3D; -1)</span><br><span class="line">        continue;</span><br><span class="line">      rec[tot++] &#x3D; now;</span><br><span class="line">      dinic(t, v);</span><br><span class="line">      dinic(u, s);</span><br><span class="line">      edges[(now - 1) * 2].cap &#x3D; edges[(now - 1) * 2 + 1].cap &#x3D; 0;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(rec, rec + tot);</span><br><span class="line">    printf(&quot;%d %d\n&quot;, ans, tot);</span><br><span class="line">    for (int i &#x3D; 0; i &lt; tot-1; i++) &#123;</span><br><span class="line">      printf(&quot;%d &quot;, rec[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    printf(&quot;%d\n&quot;, rec[tot-1]);</span><br><span class="line">  &#125;</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="mrmorning.github.io/2017/02/21/bzoj3876-AHOI2014-%E6%94%AF%E7%BA%BF%E5%89%A7%E6%83%85%E2%80%94%E2%80%94%E4%B8%8A%E4%B8%8B%E7%95%8C%E8%B4%B9%E7%94%A8%E6%B5%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Geng">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chen Geng's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/21/bzoj3876-AHOI2014-%E6%94%AF%E7%BA%BF%E5%89%A7%E6%83%85%E2%80%94%E2%80%94%E4%B8%8A%E4%B8%8B%E7%95%8C%E8%B4%B9%E7%94%A8%E6%B5%81/" class="post-title-link" itemprop="url">[bzoj3876][AHOI2014]支线剧情——上下界费用流</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-02-21 11:42:00" itemprop="dateCreated datePublished" datetime="2017-02-21T11:42:00+00:00">2017-02-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-02 09:03:59" itemprop="dateModified" datetime="2020-08-02T09:03:59+00:00">2020-08-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><p><a target="_blank" rel="noopener" href="http://www.lydsy.com/JudgeOnline/problem.php?id=3876">传送门</a></p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>建立s和t，然后s向1连下限0上限inf费用0的边，除1外所有节点向t连下限0上限inf费用0的边，对于每条边下限为1上限为inf费用为经过费用，然后我们只有做上下界网络流构出新图，跑最小费用可行流即可。<br><img src="http://i2.muimg.com/567571/03995e4b2e37f873.png"><br>变成<br><img src="http://i2.muimg.com/567571/347c8b27c0561110.png"><br>至于建立新图，我是这样建立的（如图）<br>另外推荐一篇文章：<a target="_blank" rel="noopener" href="https://oi.men.ci/network-flow-with-bounds/">Menci的博客</a></p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf = INT_MAX;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">305</span> * <span class="number">4</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">10000</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge1</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> from;</span><br><span class="line">  <span class="keyword">int</span> to;</span><br><span class="line">  <span class="keyword">int</span> low;</span><br><span class="line">  <span class="keyword">int</span> high;</span><br><span class="line">  <span class="keyword">int</span> cost;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;edge1&gt; es;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> from;</span><br><span class="line">  <span class="keyword">int</span> to;</span><br><span class="line">  <span class="keyword">int</span> cap;</span><br><span class="line">  <span class="keyword">int</span> cost;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;edge&gt; edges;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[maxn];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add_edge</span><span class="params">(<span class="keyword">int</span> from, <span class="keyword">int</span> to, <span class="keyword">int</span> cap, <span class="keyword">int</span> cost)</span> </span>&#123;</span><br><span class="line">  edges.push_back((edge)&#123;from, to, cap, cost&#125;);</span><br><span class="line">  edges.push_back((edge)&#123;to, from, <span class="number">0</span>, -cost&#125;);</span><br><span class="line">  <span class="keyword">int</span> m = edges.size();</span><br><span class="line">  G[from].push_back(m - <span class="number">2</span>);</span><br><span class="line">  G[to].push_back(m - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span> c = getchar();</span><br><span class="line">  <span class="keyword">int</span> f = <span class="number">1</span>, x = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (c == <span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">      f = <span class="number">-1</span>;</span><br><span class="line">    c = getchar();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c))</span><br><span class="line">    x = x * <span class="number">10</span> + c - <span class="string">&#x27;0&#x27;</span>, c = getchar();</span><br><span class="line">  <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n, s, t, V;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build_network</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; es.size(); i++) &#123;</span><br><span class="line">    edge1 &amp;e = es[i];</span><br><span class="line">    add_edge(e.from, e.to, e.high - e.low, e.cost);</span><br><span class="line">    add_edge(e.from, e.to, e.low, e.cost - M);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> dist[maxn], a[maxn], pree[maxn], inq[maxn];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> &amp;cost)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; V; i++)</span><br><span class="line">    dist[i] = inf;</span><br><span class="line">  <span class="built_in">memset</span>(pree, <span class="number">0</span>, <span class="keyword">sizeof</span>(pree));</span><br><span class="line">  <span class="built_in">memset</span>(inq, <span class="number">0</span>, <span class="keyword">sizeof</span>(inq));</span><br><span class="line">  a[s] = inf;</span><br><span class="line">  dist[s] = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">  q.push(s);</span><br><span class="line">  inq[s] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">    <span class="keyword">int</span> u = q.front();</span><br><span class="line">    q.pop();</span><br><span class="line">    inq[u] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[u].size(); i++) &#123;</span><br><span class="line">      edge &amp;e = edges[G[u][i]];</span><br><span class="line">      <span class="keyword">if</span> (e.cap &gt; <span class="number">0</span> &amp;&amp; dist[e.to] &gt; dist[u] + e.cost) &#123;</span><br><span class="line">        pree[e.to] = G[u][i];</span><br><span class="line">        dist[e.to] = dist[u] + e.cost;</span><br><span class="line">        a[e.to] = min(e.cap, a[u]);</span><br><span class="line">        <span class="keyword">if</span> (!inq[e.to]) &#123;</span><br><span class="line">          q.push(e.to);</span><br><span class="line">          inq[e.to] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (dist[t] &gt;= inf)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  cost += a[t] * dist[t];</span><br><span class="line">  <span class="keyword">int</span> u = t;</span><br><span class="line">  <span class="keyword">while</span> (u != s) &#123;</span><br><span class="line">    edges[pree[u]].cap -= a[t];</span><br><span class="line">    edges[pree[u] ^ <span class="number">1</span>].cap += a[t];</span><br><span class="line">    u = edges[pree[u]].from;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mcmf</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> cost = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (spfa(s, t, cost))</span><br><span class="line">    ;</span><br><span class="line">  <span class="comment">//    cout &lt;&lt; &quot;Hey:&quot; &lt;&lt; cost &lt;&lt; endl;</span></span><br><span class="line">  <span class="keyword">return</span> cost;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">//  freopen(&quot;input&quot;, &quot;r&quot;, stdin);</span></span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  s = <span class="number">0</span>, t = n + <span class="number">1</span>, V = t + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">  es.push_back((edge1)&#123;s, <span class="number">1</span>, <span class="number">0</span>, inf, <span class="number">0</span>&#125;);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    <span class="keyword">int</span> k;</span><br><span class="line">    k = read();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; k; j++) &#123;</span><br><span class="line">      <span class="keyword">int</span> a, b;</span><br><span class="line">      a = read();</span><br><span class="line">      b = read();</span><br><span class="line">      es.push_back((edge1)&#123;i, a, <span class="number">1</span>, inf, b&#125;);</span><br><span class="line">      cnt += <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    es.push_back((edge1)&#123;i, t, <span class="number">0</span>, inf, <span class="number">0</span>&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  build_network();</span><br><span class="line">  <span class="keyword">int</span> ans = mcmf(s, t);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, ans + M * cnt);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="mrmorning.github.io/2017/02/21/bzoj2127-happiness%E2%80%94%E2%80%94%E6%9C%80%E5%B0%8F%E5%89%B2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Geng">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chen Geng's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/21/bzoj2127-happiness%E2%80%94%E2%80%94%E6%9C%80%E5%B0%8F%E5%89%B2/" class="post-title-link" itemprop="url">[bzoj2127]happiness——最小割</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-02-21 08:13:00" itemprop="dateCreated datePublished" datetime="2017-02-21T08:13:00+00:00">2017-02-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-02 09:03:59" itemprop="dateModified" datetime="2020-08-02T09:03:59+00:00">2020-08-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>#这个题太恶心了。。。并不想继续做了。。。<br><strong>本代码在bzoj上TLE！</strong><br>大致说一下思路：   建立ST，首先由S连边(S,u,a)a代表学文的分数，连向T(u,T,b)b表示学理的分数，这样构造出了两个人独立的分数。</p>
<p>然后考虑联合分数，对于相邻的两个点xy，看下图（盗个图：<br><img src="http://images2015.cnblogs.com/blog/890886/201702/890886-20170221081306351-455916177.png"></p>
<p>　 设xy都学文的分数为w1,都学理的分数为w2，则a=w1/2,b=w1/2,c=w2/2,d=w2/2,e=(w1+w2)/2，每一种割与其对应的亏损分数如下：</p>
<pre><code>　　a+b          -w1　　　　　　都学理-&gt;w2

　　c+d          -w2　　　　　　都学文-&gt;w1

　　a+d+e       -w1-w2　　　  不同-&gt;   0

　　c+d+e       -w1-w2　　　　...</code></pre>
<p>　 注意双向边e，我们是变成两条有向边加入网络，而又因为我们求最小割用的是最大流的算法，所以这条边可以看作是一条双向且权值为e的边。</p>
<p>　 然后把权值*2，解决精度问题。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">const int maxn &#x3D; 105; &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span><br><span class="line">const int maxv &#x3D; maxn * maxn * 2;</span><br><span class="line">const int inf &#x3D; INT_MAX;</span><br><span class="line">int n, m, s, t, v;</span><br><span class="line">struct edge &#123;</span><br><span class="line">  int from;</span><br><span class="line">  int to;</span><br><span class="line">  int cap;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;edge&gt; edges;</span><br><span class="line">vector&lt;int&gt; G[maxv];</span><br><span class="line">int dist[maxv], iter[maxv];</span><br><span class="line">int z[maxv][maxv];</span><br><span class="line">bool zz[maxv][maxv];</span><br><span class="line">inline int read() &#123;</span><br><span class="line">  char c &#x3D; getchar();</span><br><span class="line">  int f &#x3D; 1, x &#x3D; 0;</span><br><span class="line">  while (!isdigit(c)) &#123;</span><br><span class="line">    if (c &#x3D;&#x3D; &#39;-&#39;)</span><br><span class="line">      f &#x3D; -1;</span><br><span class="line">    c &#x3D; getchar();</span><br><span class="line">  &#125;</span><br><span class="line">  while (isdigit(c))</span><br><span class="line">    x &#x3D; x * 10 + c - &#39;0&#39;, c &#x3D; getchar();</span><br><span class="line">  return x * f;</span><br><span class="line">&#125;</span><br><span class="line">inline void add_edge(int from, int to, int cap) &#123;</span><br><span class="line">  edges.push_back((edge)&#123;from, to, cap&#125;);</span><br><span class="line">  edges.push_back((edge)&#123;to, from, 0&#125;);</span><br><span class="line">  int m &#x3D; edges.size();</span><br><span class="line">  G[from].push_back(m - 2);</span><br><span class="line">  G[to].push_back(m - 1);</span><br><span class="line">&#125;</span><br><span class="line">inline void bfs(int s) &#123;</span><br><span class="line">  memset(dist, -1, sizeof(dist));</span><br><span class="line">  dist[s] &#x3D; 0;</span><br><span class="line">  queue&lt;int&gt; q;</span><br><span class="line">  q.push(s);</span><br><span class="line">  while (!q.empty()) &#123;</span><br><span class="line">    int u &#x3D; q.front();</span><br><span class="line">    q.pop();</span><br><span class="line">    for (int i &#x3D; 0; i &lt; G[u].size(); i++) &#123;</span><br><span class="line">      edge &amp;e &#x3D; edges[G[u][i]];</span><br><span class="line">      if (e.cap &gt; 0 &amp;&amp; dist[e.to] &#x3D;&#x3D; -1) &#123;</span><br><span class="line">        dist[e.to] &#x3D; dist[u] + 1;</span><br><span class="line">        q.push(e.to);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">inline int dfs(int s, int t, int flow) &#123;</span><br><span class="line">  if (s &#x3D;&#x3D; t)</span><br><span class="line">    return flow;</span><br><span class="line">  for (int &amp;i &#x3D; iter[s]; i &lt; G[s].size(); i++) &#123;</span><br><span class="line">    edge &amp;e &#x3D; edges[G[s][i]];</span><br><span class="line">    if (e.cap &gt; 0 &amp;&amp; dist[e.to] &gt; dist[s]) &#123;</span><br><span class="line">      int d &#x3D; dfs(e.to, t, min(flow, e.cap));</span><br><span class="line">      if (d &gt; 0) &#123;</span><br><span class="line">        e.cap -&#x3D; d;</span><br><span class="line">        edges[G[s][i] ^ 1].cap +&#x3D; d;</span><br><span class="line">        return d;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br><span class="line">inline int dinic(int s, int t) &#123;</span><br><span class="line">  int flow &#x3D; 0;</span><br><span class="line">  while (1) &#123;</span><br><span class="line">    bfs(s);</span><br><span class="line">    if (dist[t] &#x3D;&#x3D; -1)</span><br><span class="line">      return flow;</span><br><span class="line">    memset(iter, 0, sizeof(iter));</span><br><span class="line">    int F;</span><br><span class="line">    while (F &#x3D; dfs(s, t, inf))</span><br><span class="line">      flow +&#x3D; F;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">int main() &#123;</span><br><span class="line">  &#x2F;&#x2F; freopen(&quot;input&quot;, &quot;r&quot;, stdin); &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span><br><span class="line">  memset(z, 0, sizeof(z));</span><br><span class="line">  memset(zz, 0, sizeof(zz));</span><br><span class="line">  scanf(&quot;%d %d&quot;, &amp;n, &amp;m);</span><br><span class="line">  s &#x3D; 0;         &#x2F;&#x2F;文科</span><br><span class="line">  t &#x3D; n * m + 1; &#x2F;&#x2F;理科</span><br><span class="line">  v &#x3D; t + 1;</span><br><span class="line">  int ans &#x3D; 0;</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; n; i++)</span><br><span class="line">    for (int j &#x3D; 1; j &lt;&#x3D; m; j++) &#123;</span><br><span class="line">      int x;</span><br><span class="line">      x &#x3D; read();</span><br><span class="line">      x &lt;&lt;&#x3D; 1;</span><br><span class="line">      z[s][(i - 1) * m + j] +&#x3D; x;</span><br><span class="line">      zz[s][(i - 1) * m + j] &#x3D; 1;</span><br><span class="line">    &#125;</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; n; i++)</span><br><span class="line">    for (int j &#x3D; 1; j &lt;&#x3D; m; j++) &#123;</span><br><span class="line">      int x;</span><br><span class="line">      x &#x3D; read();</span><br><span class="line">      x &lt;&lt;&#x3D; 1;</span><br><span class="line">      z[(i - 1) * m + j][t] +&#x3D; x;</span><br><span class="line">      zz[(i - 1) * m + j][t] &#x3D; 1;</span><br><span class="line">    &#125;</span><br><span class="line">  for (int i &#x3D; 1; i &lt; n; i++) &#123;</span><br><span class="line">    for (int j &#x3D; 1; j &lt;&#x3D; m; j++) &#123;</span><br><span class="line">      int x;</span><br><span class="line">      x &#x3D; read();</span><br><span class="line">      z[(i - 1) * m + j][i * m + j] +&#x3D; x;</span><br><span class="line">      z[s][(i - 1) * m + j] +&#x3D; x;</span><br><span class="line">      z[s][i * m + j] +&#x3D; x;</span><br><span class="line">      zz[(i - 1) * m + j][i * m + j] &#x3D; 1;</span><br><span class="line">      zz[s][(i - 1) * m + j] &#x3D; 1;</span><br><span class="line">      zz[s][i * m + j] &#x3D; 1;</span><br><span class="line">      add_edge((i - 1) * m + j, i * m + j, x);</span><br><span class="line">      add_edge(i * m + j, (i - 1) * m + j, x);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  for (int i &#x3D; 1; i &lt; n; i++) &#123;</span><br><span class="line">    for (int j &#x3D; 1; j &lt;&#x3D; m; j++) &#123;</span><br><span class="line">      int x;</span><br><span class="line">      x &#x3D; read();</span><br><span class="line">      z[(i - 1) * m + j][i * m + j] +&#x3D; x;</span><br><span class="line">      z[(i - 1) * m + j][t] +&#x3D; x;</span><br><span class="line">      z[i * m + j][t] +&#x3D; x;</span><br><span class="line">      zz[(i - 1) * m + j][i * m + j] &#x3D; 1;</span><br><span class="line">      zz[(i - 1) * m + j][t] &#x3D; 1;</span><br><span class="line">      zz[i * m + j][t] &#x3D; 1;</span><br><span class="line">      add_edge((i - 1) * m + j, i * m + j, x);</span><br><span class="line">      add_edge(i * m + j, (i - 1) * m + j, x);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; n; i++) &#123;</span><br><span class="line">    for (int j &#x3D; 1; j &lt; m; j++) &#123;</span><br><span class="line">      int x;</span><br><span class="line">      x &#x3D; read();</span><br><span class="line">      z[(i - 1) * m + j][(i - 1) * m + j + 1] +&#x3D; x;</span><br><span class="line">      z[s][(i - 1) * m + j] +&#x3D; x;</span><br><span class="line">      z[s][(i - 1) * m + j + 1] +&#x3D; x;</span><br><span class="line">      zz[(i - 1) * m + j][(i - 1) * m + j + 1] &#x3D; 1;</span><br><span class="line">      zz[s][(i - 1) * m + j] &#x3D; 1;</span><br><span class="line">      zz[s][(i - 1) * m + j + 1] &#x3D; 1;</span><br><span class="line">      add_edge((i - 1) * m + j, (i - 1) * m + j + 1, x);</span><br><span class="line">      add_edge((i - 1) * m + j + 1, (i - 1) * m + j, x);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; n; i++) &#123;</span><br><span class="line">    for (int j &#x3D; 1; j &lt; m; j++) &#123;</span><br><span class="line">      int x;</span><br><span class="line">      x &#x3D; read();</span><br><span class="line">      z[(i - 1) * m + j][(i - 1) * m + j + 1] +&#x3D; x;</span><br><span class="line">      z[(i - 1) * m + j][t] +&#x3D; x;</span><br><span class="line">      z[(i - 1) * m + j + 1][t] +&#x3D; x;</span><br><span class="line">      zz[(i - 1) * m + j][(i - 1) * m + j + 1] &#x3D; 1;</span><br><span class="line">      zz[(i - 1) * m + j][t] &#x3D; 1;</span><br><span class="line">      zz[(i - 1) * m + j + 1][t] &#x3D; 1;</span><br><span class="line">      add_edge((i - 1) * m + j, (i - 1) * m + j + 1, x);</span><br><span class="line">      add_edge((i - 1) * m + j + 1, (i - 1) * m + j, x);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  for (int i &#x3D; 1; i &lt; t; i++) &#123;</span><br><span class="line">    ans +&#x3D; z[s][i];</span><br><span class="line">    ans +&#x3D; z[i][t];</span><br><span class="line">    if (zz[s][i])</span><br><span class="line">      add_edge(s, i, z[s][i]);</span><br><span class="line">    if (zz[i][t])</span><br><span class="line">      add_edge(i, t, z[i][t]);</span><br><span class="line">  &#125;</span><br><span class="line">  for (int i &#x3D; 1; i &lt; t; i++) &#123;</span><br><span class="line">    for (int j &#x3D; 1; j &lt; t; j++) &#123;</span><br><span class="line">      if (zz[i][j]) &#123;</span><br><span class="line">        add_edge(i, j, z[i][j]);</span><br><span class="line">        add_edge(j, i, z[i][j]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &#x2F;*  for (int i &#x3D; 0; i &lt; v; i++) &#123;</span><br><span class="line">      cout &lt;&lt; &quot;For &quot; &lt;&lt; i &lt;&lt; &#39;:&#39; &lt;&lt; endl;</span><br><span class="line">      for (int j &#x3D; 0; j &lt; G[i].size(); j++) &#123;</span><br><span class="line">        edge &amp;e &#x3D; edges[G[i][j]];</span><br><span class="line">        if (e.cap &gt; 0)</span><br><span class="line">          cout &lt;&lt; &quot;to &quot; &lt;&lt; e.to &lt;&lt; &quot; cap &quot; &lt;&lt; e.cap &lt;&lt; endl;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;*&#x2F;</span><br><span class="line">  ans -&#x3D; dinic(s, t);</span><br><span class="line">  printf(&quot;%d\n&quot;, ans &gt;&gt; 1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="mrmorning.github.io/2017/02/20/bzoj3158-%E5%8D%83%E9%92%A7%E4%B8%80%E5%8F%91%E2%80%94%E2%80%94%E4%BA%8C%E5%88%86%E5%9B%BE-%E7%BD%91%E7%BB%9C%E6%B5%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Geng">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chen Geng's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/20/bzoj3158-%E5%8D%83%E9%92%A7%E4%B8%80%E5%8F%91%E2%80%94%E2%80%94%E4%BA%8C%E5%88%86%E5%9B%BE-%E7%BD%91%E7%BB%9C%E6%B5%81/" class="post-title-link" itemprop="url">[bzoj3158]千钧一发——二分图+网络流</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-02-20 16:26:00" itemprop="dateCreated datePublished" datetime="2017-02-20T16:26:00+00:00">2017-02-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-02 09:03:59" itemprop="dateModified" datetime="2020-08-02T09:03:59+00:00">2020-08-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><p><a target="_blank" rel="noopener" href="http://www.lydsy.com/JudgeOnline/problem.php?id=3158">传送门</a></p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>很容易建立模型，如果两个点不能匹配，那么连一条边，那么问题就转化为了求一个图上的最大点权独立集。<br>而我们可以知道：<br>最大点权独立集+最小点权覆盖集=总权值。<br>同时最小点权覆盖在一般图上是np的，但是在二分图上就是可解的。<br>利用一系列数学性质，可以证明A[i]与A[j]奇偶性不同是ij之间连边的充分必要条件。<br>详细见<a target="_blank" rel="noopener" href="http://www.cnblogs.com/lidaxin/p/5078060.html">lidaxin的博客</a><br>那么我们可以跑一边最大流即可。</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1005</span>;</span><br><span class="line"><span class="keyword">const</span> ll inf = <span class="number">100000000000000</span>;</span><br><span class="line">ll N, A[maxn], B[maxn];</span><br><span class="line">ll mx = <span class="number">0</span>;</span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll a, ll b)</span> </span>&#123; <span class="keyword">return</span> b == <span class="number">0</span> ? a : gcd(b, a % b); &#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">ok</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">  ll sq = a * a + b * b;</span><br><span class="line">  ll t = <span class="built_in">sqrt</span>(sq);</span><br><span class="line">  <span class="keyword">if</span> (sq != (t * t))</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">if</span> (gcd(a, b) &gt; <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span> &#123;</span></span><br><span class="line">  ll from;</span><br><span class="line">  ll to;</span><br><span class="line">  ll cap;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;edge&gt; edges;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[maxn];</span><br><span class="line">ll s, t, v, ans;</span><br><span class="line">ll dist[maxn], iter[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_edge</span><span class="params">(<span class="keyword">int</span> from, <span class="keyword">int</span> to, ll cap)</span> </span>&#123;</span><br><span class="line">  edges.push_back((edge)&#123;from, to, cap&#125;);</span><br><span class="line">  edges.push_back((edge)&#123;to, from, <span class="number">0</span>&#125;);</span><br><span class="line">  <span class="keyword">int</span> m = edges.size();</span><br><span class="line">  G[from].push_back(m - <span class="number">2</span>);</span><br><span class="line">  G[to].push_back(m - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">(<span class="keyword">int</span> s)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">memset</span>(dist, <span class="number">-1</span>, <span class="keyword">sizeof</span>(dist));</span><br><span class="line">  <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">  q.push(s);</span><br><span class="line">  dist[s] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">    <span class="keyword">int</span> u = q.front();</span><br><span class="line">    q.pop();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[u].size(); i++) &#123;</span><br><span class="line">      edge &amp;e = edges[G[u][i]];</span><br><span class="line">      <span class="keyword">if</span> (e.cap &gt; <span class="number">0</span> &amp;&amp; dist[e.to] == <span class="number">-1</span>) &#123;</span><br><span class="line">        dist[e.to] = dist[u] + e.cap;</span><br><span class="line">        q.push(e.to);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">dfs</span><span class="params">(ll s, ll t, ll flow)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (s == t)</span><br><span class="line">    <span class="keyword">return</span> flow;</span><br><span class="line">  <span class="keyword">for</span> (ll &amp;i = iter[s]; i &lt; G[s].size(); i++) &#123;</span><br><span class="line">    edge &amp;e = edges[G[s][i]];</span><br><span class="line">    <span class="keyword">if</span> (e.cap &gt; <span class="number">0</span> &amp;&amp; dist[e.to] &gt; dist[s]) &#123;</span><br><span class="line">      ll d = dfs(e.to, t, min(flow, e.cap));</span><br><span class="line">      <span class="keyword">if</span> (d &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        e.cap -= d;</span><br><span class="line">        edges[G[s][i] ^ <span class="number">1</span>].cap += d;</span><br><span class="line">        <span class="keyword">return</span> d;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">dinic</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">  ll flow = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">    bfs(s);</span><br><span class="line">    <span class="keyword">if</span> (dist[t] == <span class="number">-1</span>)</span><br><span class="line">      <span class="keyword">return</span> flow;</span><br><span class="line">    <span class="built_in">memset</span>(iter, <span class="number">0</span>, <span class="keyword">sizeof</span>(iter));</span><br><span class="line">    ll f;</span><br><span class="line">    <span class="keyword">while</span> ((f = dfs(s, t, inf)) &gt; <span class="number">0</span>)</span><br><span class="line">      flow += f;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">//  freopen(&quot;input.b&quot;, &quot;r&quot;, stdin);</span></span><br><span class="line">  ans = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;N);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;A[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;B[i]);</span><br><span class="line">    ans += B[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// s:0, t:N+1</span></span><br><span class="line">  s = <span class="number">0</span>, t = N + <span class="number">1</span>, v = t + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (A[i] &amp; <span class="number">1</span>)</span><br><span class="line">      add_edge(s, i, B[i]);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      add_edge(i, t, B[i]);</span><br><span class="line">    <span class="keyword">if</span> (A[i] &amp; <span class="number">1</span>)</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!(A[j] &amp; <span class="number">1</span>))</span><br><span class="line">          <span class="keyword">if</span> (ok(A[i], A[j]))</span><br><span class="line">            add_edge(i, j, inf);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  ans -= dinic(s, t);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>, ans);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="mrmorning.github.io/2017/02/20/bzoj2245-SDOI2011-%E5%B7%A5%E4%BD%9C%E5%AE%89%E6%8E%92%E2%80%94%E2%80%94%E8%B4%B9%E7%94%A8%E6%B5%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Geng">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chen Geng's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/20/bzoj2245-SDOI2011-%E5%B7%A5%E4%BD%9C%E5%AE%89%E6%8E%92%E2%80%94%E2%80%94%E8%B4%B9%E7%94%A8%E6%B5%81/" class="post-title-link" itemprop="url">[bzoj2245][SDOI2011]工作安排——费用流</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-02-20 10:52:00" itemprop="dateCreated datePublished" datetime="2017-02-20T10:52:00+00:00">2017-02-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-02 09:03:59" itemprop="dateModified" datetime="2020-08-02T09:03:59+00:00">2020-08-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="题目大意："><a href="#题目大意：" class="headerlink" title="题目大意："></a>题目大意：</h1><p><a target="_blank" rel="noopener" href="http://www.lydsy.com/JudgeOnline/problem.php?id=2245">传送门</a></p>
<h1 id="题解："><a href="#题解：" class="headerlink" title="题解："></a>题解：</h1><p>很容易建模，把每一个工作人员拆成两个点，由第一个点向第二个点连S+1条边即可。<br>这水题没什么难度，主要是longlong卡的丧心病狂。。。</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> ll maxn = <span class="number">2550</span>;</span><br><span class="line"><span class="keyword">const</span> ll maxv = maxn * <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> ll inf = <span class="number">1000000000000</span>;</span><br><span class="line">ll dist[maxv], inq[maxv], pree[maxv], fl[maxv];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span> &#123;</span></span><br><span class="line">  ll from;</span><br><span class="line">  ll to;</span><br><span class="line">  ll cap;</span><br><span class="line">  ll cost;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;edge&gt; edges;</span><br><span class="line"><span class="built_in">vector</span>&lt;ll&gt; G[maxv];</span><br><span class="line">ll n, m, a[maxn][maxn], c[maxn], v;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_edge</span><span class="params">(ll from, ll to, ll cap, ll cost)</span> </span>&#123;</span><br><span class="line">  edges.push_back((edge)&#123;from, to, cap, cost&#125;);</span><br><span class="line">  edges.push_back((edge)&#123;to, from, <span class="number">0</span>, -cost&#125;);</span><br><span class="line">  ll m = edges.size();</span><br><span class="line">  G[from].push_back(m - <span class="number">2</span>);</span><br><span class="line">  G[to].push_back(m - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">spfa</span><span class="params">(ll s, ll t, ll &amp;cost)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; v; i++)</span><br><span class="line">    dist[i] = inf;</span><br><span class="line">  <span class="built_in">memset</span>(inq, <span class="number">0</span>, <span class="keyword">sizeof</span>(inq));</span><br><span class="line">  <span class="built_in">memset</span>(pree, <span class="number">0</span>, <span class="keyword">sizeof</span>(pree));</span><br><span class="line">  <span class="built_in">memset</span>(fl, <span class="number">0</span>, <span class="keyword">sizeof</span>(fl));</span><br><span class="line">  <span class="built_in">queue</span>&lt;ll&gt; q;</span><br><span class="line">  fl[s] = inf;</span><br><span class="line">  dist[s] = <span class="number">0</span>, inq[s] = <span class="number">1</span>;</span><br><span class="line">  q.push(s);</span><br><span class="line">  <span class="keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">    ll u = q.front();</span><br><span class="line">    q.pop();</span><br><span class="line">    inq[u] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[u].size(); i++) &#123;</span><br><span class="line">      edge &amp;e = edges[G[u][i]];</span><br><span class="line">      <span class="keyword">if</span> (e.cap &gt; <span class="number">0</span> &amp;&amp; dist[e.to] &gt; dist[u] + e.cost) &#123;</span><br><span class="line">        dist[e.to] = dist[u] + e.cost;</span><br><span class="line">        pree[e.to] = G[u][i];</span><br><span class="line">        fl[e.to] = min(fl[u], e.cap);</span><br><span class="line">        <span class="keyword">if</span> (!inq[e.to]) &#123;</span><br><span class="line">          q.push(e.to);</span><br><span class="line">          inq[e.to] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (dist[t] &gt;= inf)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  ll flow = fl[t];</span><br><span class="line">  cost += flow * dist[t];</span><br><span class="line">  ll u = t;</span><br><span class="line">  <span class="keyword">while</span> (!u == s) &#123;</span><br><span class="line">    edges[pree[u]].cap -= flow;</span><br><span class="line">    edges[pree[u] ^ <span class="number">1</span>].cap += flow;</span><br><span class="line">    u = edges[pree[u]].from;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">mcmf</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">  ll cost = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (spfa(s, t, cost))</span><br><span class="line">    ;</span><br><span class="line">  <span class="keyword">return</span> cost;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 1-m：员工</span></span><br><span class="line">  <span class="comment">// m+1~m+n 产品</span></span><br><span class="line">  <span class="comment">// m+n+1~m+n+m 拆点后的员工</span></span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%lld %lld&quot;</span>, &amp;m, &amp;n);</span><br><span class="line">  ll s = <span class="number">0</span>, t = n + m + m + <span class="number">1</span>;</span><br><span class="line">  v = t + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;c[i]);</span><br><span class="line">    add_edge(m + i, t, c[i], <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">      <span class="keyword">int</span> x;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">      <span class="keyword">if</span> (x)</span><br><span class="line">        add_edge(i, j + m, inf, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">    add_edge(s, n + m + i, inf, <span class="number">0</span>);</span><br><span class="line">    ll s;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;s);</span><br><span class="line">    ll T[maxn];</span><br><span class="line">    T[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= s; j++)</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;T[j]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= s; j++) &#123;</span><br><span class="line">      ll y;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;y);</span><br><span class="line">      add_edge(n + m + i, i, T[j] - T[j - <span class="number">1</span>], y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;s);</span><br><span class="line">    add_edge(n + m + i, i, inf, s);</span><br><span class="line">  &#125;</span><br><span class="line">  ll ans = mcmf(s, t);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// freopen(&quot;input&quot;, &quot;r&quot;, stdin);</span></span><br><span class="line">  solve();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/9/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/11/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Chen Geng</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">179</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">96</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

      
<script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
<script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
<div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div id="myCanvasContainer" class="widget tagcloud">
        <canvas width="250" height="250" id="resCanvas" style="width:100%">
            <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/2-SAT/" rel="tag">2-SAT</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AC%E8%87%AA%E5%8A%A8%E6%9C%BA/" rel="tag">AC自动机</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BSGS/" rel="tag">BSGS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CDQ%E5%88%86%E6%B2%BB/" rel="tag">CDQ分治</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FFT/" rel="tag">FFT</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/KMP/" rel="tag">KMP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Manacher/" rel="tag">Manacher</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NTT/" rel="tag">NTT</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Polya%E5%AE%9A%E7%90%86/" rel="tag">Polya定理</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Prufer%E7%BC%96%E7%A0%81/" rel="tag">Prufer编码</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/STL/" rel="tag">STL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Trie/" rel="tag">Trie</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dfs%E5%BA%8F%E5%88%97/" rel="tag">dfs序列</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lca/" rel="tag">lca</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lct/" rel="tag">lct</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spfa/" rel="tag">spfa</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/splay/" rel="tag">splay</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%8A%E4%B8%8B%E7%95%8C%E7%BD%91%E7%BB%9C%E6%B5%81/" rel="tag">上下界网络流</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%BB%E5%B8%AD%E6%A0%91/" rel="tag">主席树</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B9%B1%E6%90%9E/" rel="tag">乱搞</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%8C%E5%88%86/" rel="tag">二分</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%8C%E5%88%86%E5%9B%BE/" rel="tag">二分图</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BB%A3%E4%BB%B7%E6%8F%90%E5%89%8D%E8%AE%A1%E7%AE%97/" rel="tag">代价提前计算</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%80%8D%E5%A2%9E/" rel="tag">倍增</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%87%B8%E5%8C%85/" rel="tag">凸包</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%86%E5%9D%97/" rel="tag">分块</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%86%E5%B1%82%E5%9B%BE/" rel="tag">分层图</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%86%E6%95%B0%E8%A7%84%E5%88%92/" rel="tag">分数规划</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8A%A8%E6%80%81%E7%82%B9%E5%88%86%E6%B2%BB/" rel="tag">动态点分治</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" rel="tag">动态规划</a><span class="tag-list-count">20</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%95%E8%B0%83%E6%A0%88/" rel="tag">单调栈</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/" rel="tag">单调队列</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%9A%E5%BC%88%E8%AE%BA/" rel="tag">博弈论</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8E%9F%E6%A0%B9/" rel="tag">原根</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%90%8E%E7%BC%80%E6%95%B0%E7%BB%84/" rel="tag">后缀数组</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA/" rel="tag">后缀自动机</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9B%BE%E8%AE%BA/" rel="tag">图论</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F/" rel="tag">多项式</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A5%BD%E9%A2%98/" rel="tag">好题</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AD%97%E5%85%B8%E5%BA%8F/" rel="tag">字典序</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/" rel="tag">字符串</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%93%88%E5%B8%8C/" rel="tag">字符串哈希</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="tag">学习笔记</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%B9%E6%96%A5%E5%8E%9F%E7%90%86/" rel="tag">容斥原理</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B9%B3%E9%9D%A2%E5%9B%BE/" rel="tag">平面图</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B9%B6%E6%9F%A5%E9%9B%86/" rel="tag">并查集</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B9%BF%E4%B9%89%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA/" rel="tag">广义后缀自动机</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BC%BA%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/" rel="tag">强连通分量</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8B%86%E7%82%B9/" rel="tag">拆点</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8B%AC%E5%8F%B7%E5%BA%8F%E5%88%97/" rel="tag">括号序列</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%90%9C%E7%B4%A2/" rel="tag">搜索</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%91%B8%E9%B1%BC/" rel="tag">摸鱼</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E4%BD%8DDP/" rel="tag">数位DP</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6%E7%9F%A5%E8%AF%86/" rel="tag">数学知识</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">数据结构</a><span class="tag-list-count">37</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E8%AE%BA/" rel="tag">数论</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/" rel="tag">斜率优化</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%80%E5%A4%A7%E6%B5%81/" rel="tag">最大流</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%80%E5%B0%8F%E5%89%B2/" rel="tag">最小割</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%83%E5%80%BC%E7%BA%BF%E6%AE%B5%E6%A0%91/" rel="tag">权值线段树</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%8E%E8%B6%85%E7%BA%BF%E6%AE%B5%E6%A0%91/" rel="tag">李超线段树</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9E%9A%E4%B8%BE/" rel="tag">枚举</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A0%91%E4%B8%8A%E5%80%8D%E5%A2%9E/" rel="tag">树上倍增</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A0%91%E5%A5%97%E6%A0%91/" rel="tag">树套树</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A0%91%E5%BD%A2DP/" rel="tag">树形DP</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A0%91%E5%BD%A2dp/" rel="tag">树形dp</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/" rel="tag">树状数组</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A0%91%E9%93%BE%E5%89%96%E5%88%86/" rel="tag">树链剖分</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A8%A1%E5%9E%8B%E8%BD%AC%E5%8C%96/" rel="tag">模型转化</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A8%A1%E6%9D%BF/" rel="tag">模板</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0/" rel="tag">欧拉函数</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%82%B9%E5%88%86%E6%B2%BB/" rel="tag">点分治</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%89%B9%E6%AE%8A%E6%95%B0%E5%88%97/" rel="tag">特殊数列</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%8A%B6%E5%8E%8BDP/" rel="tag">状压DP</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/" rel="tag">生成函数</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%94%9F%E6%88%90%E6%A0%91/" rel="tag">生成树</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%94%9F%E6%88%90%E6%A0%91%E8%AE%A1%E6%95%B0/" rel="tag">生成树计数</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9F%A9%E9%98%B5%E4%B9%98%E6%B3%95/" rel="tag">矩阵乘法</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9F%A9%E9%98%B5%E6%A0%91%E5%AE%9A%E7%90%86/" rel="tag">矩阵树定理</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/" rel="tag">离散对数</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A6%BB%E7%BA%BF%E5%A4%84%E7%90%86/" rel="tag">离线处理</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E8%A7%84%E5%88%92/" rel="tag">线性规划</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/" rel="tag">线段树</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/" rel="tag">组合数学</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%93%E8%AE%BA%E9%A2%98/" rel="tag">结论题</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/" rel="tag">网络流</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%8E%AB%E9%98%9F%E7%AE%97%E6%B3%95/" rel="tag">莫队算法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%92%9F%E8%92%BB/" rel="tag">蒟蒻</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B4%9F%E7%8E%AF/" rel="tag">负环</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B4%AA%E5%BF%83/" rel="tag">贪心</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B4%B9%E7%94%A8%E6%B5%81/" rel="tag">费用流</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%80%80%E6%B5%81/" rel="tag">退流</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%80%92%E5%BD%92/" rel="tag">递归</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83/" rel="tag">高斯消元</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%AB%98%E7%B2%BE%E5%BA%A6/" rel="tag">高精度</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%BB%98%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" rel="tag">默比乌斯反演</a><span class="tag-list-count">2</span></li></ul>
        </canvas>
    </div>
</div>


    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Chen Geng</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
