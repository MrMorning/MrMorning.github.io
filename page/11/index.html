<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"mrmorning.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Chen Geng&#39;s Blog">
<meta property="og:url" content="mrmorning.github.io/page/11/index.html">
<meta property="og:site_name" content="Chen Geng&#39;s Blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Chen Geng">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="mrmorning.github.io/page/11/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Chen Geng's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Chen Geng's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="mrmorning.github.io/2017/02/20/bzoj1070-SCOI2007-%E4%BF%AE%E8%BD%A6%E2%80%94%E2%80%94%E8%B4%B9%E7%94%A8%E6%B5%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Geng">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chen Geng's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/20/bzoj1070-SCOI2007-%E4%BF%AE%E8%BD%A6%E2%80%94%E2%80%94%E8%B4%B9%E7%94%A8%E6%B5%81/" class="post-title-link" itemprop="url">[bzoj1070][SCOI2007]修车——费用流</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-02-20 08:40:00" itemprop="dateCreated datePublished" datetime="2017-02-20T08:40:00+00:00">2017-02-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-02 09:03:59" itemprop="dateModified" datetime="2020-08-02T09:03:59+00:00">2020-08-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="题目大意："><a href="#题目大意：" class="headerlink" title="题目大意："></a>题目大意：</h1><p><a target="_blank" rel="noopener" href="http://www.lydsy.com/JudgeOnline/problem.php?id=1070">传送门</a></p>
<h1 id="题解："><a href="#题解：" class="headerlink" title="题解："></a>题解：</h1><p>本题和<a target="_blank" rel="noopener" href="http://poj.org/problem?id=3686">POJ3686</a>一题一模一样,而且还是数据缩小以后的弱化版QAQ，《挑战程序设计竞赛》一书中有详细解答，我写一下大致的解法。<br>我们把每个维修员拆成n个点，由每个车子向每个维修员连接n条边，分别代表是该维修员维修的第i个车子。<br>容易知道，如果车辆i在维修员j处是第k个修的，那么费用就一定会包括k*z[i][j]（车辆i的等待时间也包括在内）。<br>跑一边费用流就好辣。。</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">65</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf = <span class="number">0x3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxm = <span class="number">15</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxv = maxn * maxm * <span class="number">2</span>;</span><br><span class="line"><span class="keyword">int</span> z[maxn][maxm];</span><br><span class="line"><span class="keyword">int</span> n, m, v, s, t;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> from, to, cap, cost;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;edge&gt; edges;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[maxn * maxm * <span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">memset</span>(z, <span class="number">0</span>, <span class="keyword">sizeof</span>(z));</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;m, &amp;n);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m; j++)</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;z[i][j]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dist[maxv], pre[maxv], a[maxv], inq[maxv];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_edge</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> cap, <span class="keyword">int</span> cost)</span> </span>&#123;</span><br><span class="line">  edges.push_back((edge)&#123;s, t, cap, cost&#125;);</span><br><span class="line">  edges.push_back((edge)&#123;t, s, <span class="number">0</span>, -cost&#125;);</span><br><span class="line">  <span class="keyword">int</span> m = edges.size();</span><br><span class="line">  G[s].push_back(m - <span class="number">2</span>);</span><br><span class="line">  G[t].push_back(m - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> &amp;flow, <span class="keyword">int</span> &amp;cost)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; v; i++)</span><br><span class="line">    dist[i] = inf;</span><br><span class="line">  <span class="built_in">memset</span>(pre, <span class="number">-1</span>, <span class="keyword">sizeof</span>(pre));</span><br><span class="line">  <span class="built_in">memset</span>(inq, <span class="number">0</span>, <span class="keyword">sizeof</span>(inq));</span><br><span class="line">  <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">  q.push(s);</span><br><span class="line">  dist[s] = <span class="number">0</span>;</span><br><span class="line">  inq[s] = <span class="number">1</span>;</span><br><span class="line">  a[s] = inf;</span><br><span class="line">  <span class="keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">    <span class="keyword">int</span> v = q.front();</span><br><span class="line">    q.pop();</span><br><span class="line">    inq[v] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[v].size(); i++) &#123;</span><br><span class="line">      edge &amp;e = edges[G[v][i]];</span><br><span class="line">      <span class="keyword">if</span> (e.cap &gt; <span class="number">0</span> &amp;&amp; dist[e.to] &gt; dist[v] + e.cost) &#123;</span><br><span class="line">        a[e.to] = min(a[v], e.cap);</span><br><span class="line">        pre[e.to] = G[v][i];</span><br><span class="line">        dist[e.to] = dist[v] + e.cost;</span><br><span class="line">        <span class="keyword">if</span> (!inq[e.to]) &#123;</span><br><span class="line">          q.push(e.to);</span><br><span class="line">          inq[e.to] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (dist[t] &gt;= inf)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  flow += a[t];</span><br><span class="line">  cost += dist[t] * a[t];</span><br><span class="line">  <span class="keyword">int</span> u = t;</span><br><span class="line">  <span class="keyword">while</span> (u != s) &#123;</span><br><span class="line">    edges[pre[u]].cap -= a[t];</span><br><span class="line">    edges[pre[u] ^ <span class="number">1</span>].cap += a[t];</span><br><span class="line">    u = edges[pre[u]].from;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mcmf</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> flow = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">int</span> cost = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (spfa(s, t, flow, cost))</span><br><span class="line">    ;</span><br><span class="line">  <span class="keyword">return</span> cost;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 0-n-1 车子</span></span><br><span class="line">  <span class="comment">// n-2n-1 一号工作员</span></span><br><span class="line">  <span class="comment">// 2n-3n-1 二号工作员</span></span><br><span class="line">  s = n + n * m, t = s + <span class="number">1</span>, v = t + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">    add_edge(s, i, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m; j++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; n; k++) &#123;</span><br><span class="line">      add_edge(n + j * n + k, t, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        add_edge(i, n + j * n + k, <span class="number">1</span>, (k + <span class="number">1</span>) * z[i][j]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">double</span> ans = (<span class="keyword">double</span>)mcmf(s, t) / n;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%.2f\n&quot;</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  read();</span><br><span class="line">  solve();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="mrmorning.github.io/2017/02/19/bzoj1051-HAOI2006-%E5%8F%97%E6%AC%A2%E8%BF%8E%E7%9A%84%E7%89%9B%E2%80%94%E2%80%94%E5%BC%BA%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Geng">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chen Geng's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/19/bzoj1051-HAOI2006-%E5%8F%97%E6%AC%A2%E8%BF%8E%E7%9A%84%E7%89%9B%E2%80%94%E2%80%94%E5%BC%BA%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/" class="post-title-link" itemprop="url">[bzoj1051][HAOI2006]受欢迎的牛——强连通分量</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-02-19 16:22:00" itemprop="dateCreated datePublished" datetime="2017-02-19T16:22:00+00:00">2017-02-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-02 09:03:59" itemprop="dateModified" datetime="2020-08-02T09:03:59+00:00">2020-08-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="题目大意："><a href="#题目大意：" class="headerlink" title="题目大意："></a>题目大意：</h1><p>给定一个有向图，求能够被其他所有点访问到的点的个数。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2017/02/19/bzoj1051-HAOI2006-%E5%8F%97%E6%AC%A2%E8%BF%8E%E7%9A%84%E7%89%9B%E2%80%94%E2%80%94%E5%BC%BA%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="mrmorning.github.io/2017/02/18/bzoj4513-SDOI2016-%E5%82%A8%E8%83%BD%E8%A1%A8%E2%80%94%E2%80%94%E6%95%B0%E4%BD%8Ddp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Geng">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chen Geng's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/18/bzoj4513-SDOI2016-%E5%82%A8%E8%83%BD%E8%A1%A8%E2%80%94%E2%80%94%E6%95%B0%E4%BD%8Ddp/" class="post-title-link" itemprop="url">[bzoj4513][SDOI2016]储能表——数位dp</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-02-18 21:00:00" itemprop="dateCreated datePublished" datetime="2017-02-18T21:00:00+00:00">2017-02-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-02 09:03:59" itemprop="dateModified" datetime="2020-08-02T09:03:59+00:00">2020-08-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="题目大意"><a href="#题目大意" class="headerlink" title="题目大意"></a>题目大意</h1><p>求<br>$$\sum_{i = 0}^{n-1}\sum_{j=0}^{m-1} max((i\ xor\ j)\ -\ k,\ 0)\ mod\ p$$</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>首先，开始并没有看出来这是数位dp。<br>后来发现可以一位一位的处理，每一位可以从前一位推出，所以可以考虑数位dp。<br>我们把要统计的数变为二进制表示，先考虑n位二进制的数，再考虑n-1位的数……，加起来就好辣。<br>定义f[i][1/0][1/0][1/0]为已经考虑到了第i位，第i位是否比n（第i位）小，第i位是否比m小，是否比k小的总共分数。<br>定义g[i][1/0][1/0][1/0]为已经考虑到了第i位，第i位是否比n（第i位）小，第i位是否比m小，是否比k小的所有情况总数。<br>我们从大到小考虑每一位，可以有，<br>g[i][aa][bb][cc] += g[i+1][a][b][c];<br>如果从状态(i,a,b,c)可以转移到状态(i-1, aa, bb, cc);<br>对于<br>f[i][aa][bb][cc] += f[i+1][a][b][c] + (zz-z)*(1&lt;&lt;i)*g[i+1][a][b][c];<br>前一项不必多说，后一项就是对于每一种可能都可以在前面加上1/0。<br>详细可以见代码。<br>有问题可以在评论区吐槽。。。</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line">ll f[<span class="number">62</span>][<span class="number">2</span>][<span class="number">2</span>][<span class="number">2</span>], g[<span class="number">62</span>][<span class="number">2</span>][<span class="number">2</span>][<span class="number">2</span>]; <span class="comment">//log2(10^18) = 60</span></span><br><span class="line">ll n, m, k, T, p;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;T);</span><br><span class="line">  <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">0</span>, <span class="keyword">sizeof</span>(f));</span><br><span class="line">    <span class="built_in">memset</span>(g, <span class="number">0</span>, <span class="keyword">sizeof</span>(g));</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld %lld %lld %lld&quot;</span>, &amp;n, &amp;m, &amp;k, &amp;p);</span><br><span class="line">    g[<span class="number">61</span>][<span class="number">1</span>][<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">60</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">      <span class="keyword">int</span> x = (n &gt;&gt; i) &amp; <span class="number">1</span>, y = (m &gt;&gt; i) &amp; <span class="number">1</span>, z = (k &gt;&gt; i) &amp; <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> a = <span class="number">0</span>; a &lt; <span class="number">2</span>; a++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> b = <span class="number">0</span>; b &lt; <span class="number">2</span>; b++) &#123;</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">int</span> c = <span class="number">0</span>; c &lt; <span class="number">2</span>; c++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (f[i + <span class="number">1</span>][a][b][c] || g[i + <span class="number">1</span>][a][b][c]) &#123;</span><br><span class="line">              <span class="keyword">for</span> (<span class="keyword">int</span> xx = <span class="number">0</span>; xx &lt; <span class="number">2</span>; xx++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> yy = <span class="number">0</span>; yy &lt; <span class="number">2</span>; yy++) &#123;</span><br><span class="line">                  <span class="keyword">int</span> zz = xx ^ yy;</span><br><span class="line">                  <span class="keyword">if</span> ((a &amp;&amp; x &lt; xx) || (b &amp;&amp; y &lt; yy) || (c &amp;&amp; z &gt; zz))</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                  <span class="keyword">int</span> aa = (a &amp;&amp; x == xx), bb = (b &amp; y == yy),</span><br><span class="line">                      cc = (c &amp;&amp; z == zz);</span><br><span class="line">                  g[i][aa][bb][cc] = (g[i][aa][bb][cc] + g[i + <span class="number">1</span>][a][b][c]) % p;</span><br><span class="line">                  f[i][aa][bb][cc] = (f[i][aa][bb][cc] + f[i + <span class="number">1</span>][a][b][c] +</span><br><span class="line">                                      ((zz - z) + p) % p * ((<span class="number">1l</span>l &lt;&lt; i) % p) %</span><br><span class="line">                                          p * g[i + <span class="number">1</span>][a][b][c] % p) %</span><br><span class="line">                                     p;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, f[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="mrmorning.github.io/2017/02/16/bzoj1026-SCOI2009-windy%E6%95%B0%E2%80%94%E2%80%94%E6%95%B0%E4%BD%8Ddp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Geng">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chen Geng's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/16/bzoj1026-SCOI2009-windy%E6%95%B0%E2%80%94%E2%80%94%E6%95%B0%E4%BD%8Ddp/" class="post-title-link" itemprop="url">[bzoj1026][SCOI2009]windy数——数位dp</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-02-16 21:26:00" itemprop="dateCreated datePublished" datetime="2017-02-16T21:26:00+00:00">2017-02-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-02 09:03:59" itemprop="dateModified" datetime="2020-08-02T09:03:59+00:00">2020-08-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><p>求[a,b]中的windy数个数。<br>windy数指的是任意相邻两个数位上的数至少相差2的数，比如135是，134不是。</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>感觉这个题比刚才做的那个简单多了。。。这个才真的应该是数位dp入门题嘛。<br>方程就是<br>$$f[i][j] = \sum f[i-1][k]$$<br>随便搞一搞就好辣。</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;algorithm&gt;</span><br><span class="line">#include &lt;cstdio&gt;</span><br><span class="line">#define ll long long</span><br><span class="line">using namespace std;</span><br><span class="line">const int maxn &#x3D; 13;</span><br><span class="line">ll f[maxn][maxn], a[maxn], cnt, len;</span><br><span class="line">void init(ll n) &#123;</span><br><span class="line">  len &#x3D; 0;</span><br><span class="line">  while (n) &#123;</span><br><span class="line">    a[++len] &#x3D; n % 10;</span><br><span class="line">    n &#x2F;&#x3D; 10;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">ll calc(ll x) &#123;</span><br><span class="line">  ll ans &#x3D; 0;</span><br><span class="line">  int flag &#x3D; 1;</span><br><span class="line">  if (!x)</span><br><span class="line">    return 0;</span><br><span class="line">  init(x);</span><br><span class="line">  for (int i &#x3D; 1; i &lt; len; i++)</span><br><span class="line">    for (int j &#x3D; 1; j &lt; 10; j++)</span><br><span class="line">      ans +&#x3D; f[i][j];</span><br><span class="line">  for (int j &#x3D; 1; j &lt; a[len]; j++)</span><br><span class="line">    ans +&#x3D; f[len][j];</span><br><span class="line">  for (int i &#x3D; len - 1; i; i--) &#123;</span><br><span class="line">    for (int j &#x3D; 0; j &lt; a[i]; j++)</span><br><span class="line">      if (abs(a[i + 1] - j) &gt;&#x3D; 2)</span><br><span class="line">        ans +&#x3D; f[i][j];</span><br><span class="line">    if (abs(a[i + 1] - a[i]) &lt; 2) &#123;</span><br><span class="line">      flag &#x3D; 0;</span><br><span class="line">      break;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  if (flag)</span><br><span class="line">    ans++;</span><br><span class="line">  return ans;</span><br><span class="line">&#125;</span><br><span class="line">int main() &#123;</span><br><span class="line">  for (int i &#x3D; 0; i &lt;&#x3D; 9; i++)</span><br><span class="line">    f[1][i] &#x3D; 1;</span><br><span class="line">  for (int i &#x3D; 2; i &lt;&#x3D; 12; i++) &#123;</span><br><span class="line">    for (int j &#x3D; 0; j &lt;&#x3D; 9; j++) &#123;</span><br><span class="line">      for (int k &#x3D; 0; k &lt;&#x3D; 9; k++) &#123;</span><br><span class="line">        if (abs(j - k) &gt;&#x3D; 2)</span><br><span class="line">          f[i][j] +&#x3D; f[i - 1][k];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  ll x, y;</span><br><span class="line">  scanf(&quot;%lld %lld&quot;, &amp;x, &amp;y);</span><br><span class="line">  ll ans1 &#x3D; calc(y);</span><br><span class="line">  ll ans2 &#x3D; calc(x - 1);</span><br><span class="line">  printf(&quot;%lld&quot;, ans1 - ans2);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="mrmorning.github.io/2017/02/16/bzoj1833-ZJOI2010-count-%E6%95%B0%E5%AD%97%E8%AE%A1%E6%95%B0%E2%80%94%E2%80%94%E6%95%B0%E4%BD%8Ddp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Geng">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chen Geng's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/16/bzoj1833-ZJOI2010-count-%E6%95%B0%E5%AD%97%E8%AE%A1%E6%95%B0%E2%80%94%E2%80%94%E6%95%B0%E4%BD%8Ddp/" class="post-title-link" itemprop="url">[bzoj1833][ZJOI2010]count 数字计数——数位dp</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-02-16 20:54:00" itemprop="dateCreated datePublished" datetime="2017-02-16T20:54:00+00:00">2017-02-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-02 09:03:59" itemprop="dateModified" datetime="2020-08-02T09:03:59+00:00">2020-08-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>#题目：<br>(传送门)[<a target="_blank" rel="noopener" href="http://www.lydsy.com/JudgeOnline/problem.php?id=1833%5D">http://www.lydsy.com/JudgeOnline/problem.php?id=1833]</a><br>#题解：<br>第一次接触数位dp，真的是恶心。<br>首先翻阅了很多很多一维dp，因为要处理前缀0，所以根本搞不懂。<br>查询了dalaolidaxin的博客，又查阅了资料：<br><a target="_blank" rel="noopener" href="http://wenku.baidu.com/link?url=9OS5Ybpw5wx00ahrH8ED2oyIlR1uWwrxT8N4pEg27GgBt2T2hLe4sd_h1rmpY7P0HmeHIEDw9h6_K98dPhhjoMhD2TpKcS8w1X8cC_dkPp_">初探数位dp</a><br>才完全弄懂这个题。<br>具体的，我们设<br>f[i][j][k]为考虑所有i位数，最高位为j数，之中k的数目。<br>我们可以得出方程：<br>$$f[i][j][k] = \sum f[i-1][l][k]    (j!=k)$$<br>$$f[i][j][k] = \sum f[i-1][l][k] + 10^{i-1}     (j==k)$$<br>我们对这个方程作出解释：<br>前一项非常好理解，后一项的话就是前(i-1)位数共有$10^{i-1}$个，对于其中每一个，我们都可以在前面加k。<br>这样我们预处理出来了f。<br>然后我们考虑对于n分块计算。<br>以n = 4321为例。<br>首先统计3位及以下的数，这些数字没有限制，直接加就好。<br>然后统计4位数。<br>对于一个4位数，我们一位一位向下考虑，如果最高位&lt;k，直接加，如果=k，加上n+1<br>具体见代码。<br>#代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;cstdio&gt;</span><br><span class="line">#include &lt;cstring&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">#define ll long long</span><br><span class="line">const int N &#x3D; 25;</span><br><span class="line">struct node &#123;</span><br><span class="line">  ll a[N];</span><br><span class="line">  node() &#123; memset(a, 0, sizeof(a)); &#125;</span><br><span class="line">  ll &amp;operator[](const int &amp;x) &#123; return a[x]; &#125;</span><br><span class="line">&#125;;</span><br><span class="line">node operator+(const node &amp;x, const node &amp;y) &#123;</span><br><span class="line">  node tmp;</span><br><span class="line">  for (int i &#x3D; 0; i &lt;&#x3D; 9; i++)</span><br><span class="line">    tmp.a[i] &#x3D; x.a[i] + y.a[i];</span><br><span class="line">  return tmp;</span><br><span class="line">&#125;</span><br><span class="line">int len, a[N];</span><br><span class="line">ll pow[N];</span><br><span class="line">node f[N][N];</span><br><span class="line">void init(ll n) &#123;</span><br><span class="line">  len &#x3D; 0;</span><br><span class="line">  while (n) &#123;</span><br><span class="line">    a[++len] &#x3D; n % 10;</span><br><span class="line">    n &#x2F;&#x3D; 10;</span><br><span class="line">  &#125;</span><br><span class="line">  for (int i &#x3D; 0; i &lt;&#x3D; 9; i++)</span><br><span class="line">    f[1][i][i] &#x3D; 1;</span><br><span class="line">  for (int i &#x3D; 2; i &lt;&#x3D; 14; i++) &#123;</span><br><span class="line">    for (int j &#x3D; 0; j &lt;&#x3D; 9; j++) &#123;</span><br><span class="line">      for (int k &#x3D; 0; k &lt;&#x3D; 9; k++)</span><br><span class="line">        f[i][j] &#x3D; f[i][j] + f[i - 1][k];</span><br><span class="line">      f[i][j][j] +&#x3D; pow[i - 1];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">node calc(ll n) &#123;</span><br><span class="line">  node ans;</span><br><span class="line">  if (!n)</span><br><span class="line">    return ans;</span><br><span class="line">  memset(f, 0, sizeof(f));</span><br><span class="line">  init(n);</span><br><span class="line">  &#x2F;&#x2F;统计前len-1位</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; len - 1; i++) &#123;</span><br><span class="line">    for (int j &#x3D; 1; j &lt;&#x3D; 9; j++) &#123;</span><br><span class="line">      ans &#x3D; ans + f[i][j];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &#x2F;&#x2F;开始统计len位数</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; a[len] - 1; i++)</span><br><span class="line">    ans &#x3D; ans + f[len][i];</span><br><span class="line">  n %&#x3D; pow[len - 1];</span><br><span class="line">  ans[a[len]] +&#x3D; n + 1; &#x2F;&#x2F;对于每一个最高位都可以统计一发</span><br><span class="line">  for (int i &#x3D; len - 1; i; i--) &#123;</span><br><span class="line">    for (int j &#x3D; 0; j &lt; a[i]; j++)</span><br><span class="line">      ans &#x3D; ans + f[i][j];</span><br><span class="line">    n %&#x3D; pow[i - 1];</span><br><span class="line">    ans[a[i]] +&#x3D; n + 1;</span><br><span class="line">  &#125;</span><br><span class="line">  return ans;</span><br><span class="line">&#125;</span><br><span class="line">int main() &#123;</span><br><span class="line">  pow[0] &#x3D; 1;</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; 14; i++)</span><br><span class="line">    pow[i] &#x3D; pow[i - 1] * 10;</span><br><span class="line">  ll x, y;</span><br><span class="line">  scanf(&quot;%lld %lld&quot;, &amp;x, &amp;y);</span><br><span class="line">  node ans1 &#x3D; calc(y), ans2 &#x3D; calc(x - 1);</span><br><span class="line">  for (int i &#x3D; 0; i &lt;&#x3D; 8; i++)</span><br><span class="line">    printf(&quot;%lld &quot;, ans1[i] - ans2[i]);</span><br><span class="line">  printf(&quot;%lld\n&quot;, ans1[9] - ans2[9]);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="mrmorning.github.io/2017/02/16/bzoj4514-SDOI2016-%E6%95%B0%E5%AD%97%E9%85%8D%E5%AF%B9%E2%80%94%E2%80%94%E4%BA%8C%E5%88%86%E5%9B%BE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Geng">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chen Geng's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/16/bzoj4514-SDOI2016-%E6%95%B0%E5%AD%97%E9%85%8D%E5%AF%B9%E2%80%94%E2%80%94%E4%BA%8C%E5%88%86%E5%9B%BE/" class="post-title-link" itemprop="url">[bzoj4514][SDOI2016]数字配对——二分图</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-02-16 18:38:00" itemprop="dateCreated datePublished" datetime="2017-02-16T18:38:00+00:00">2017-02-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-02 09:03:59" itemprop="dateModified" datetime="2020-08-02T09:03:59+00:00">2020-08-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><p><a target="_blank" rel="noopener" href="http://www.lydsy.com/JudgeOnline/problem.php?id=4514">传送门</a></p>
<h1 id="题解："><a href="#题解：" class="headerlink" title="题解："></a>题解：</h1><p>这个题真的是巨坑，经过了6个WA，2个TLE，1个RE后才终于搞出来，中间都有点放弃希望了。。。<br>主要是一定要注意longlong！<br>下面开始说明题解。<br>朴素的想法是：<br>如果两个数字可以匹配，那么连一条边，那么问题就转化成了一个图的最大边匹配。<br>然而，一般图的最大边匹配是NP的，所以竞赛中一定不会出。<br>所以，这种题目一般会满足二分图性质。<br>我们可以跑几组大数据，进行二分图染色，发现的确是二分图。<br>仔细思考就可以发现，如果我们设f[i]为i的质因数个数，那么如果i和j可以配对，他们的f值奇偶性一定不同！<br>所以这个图一定是二分图。<br>跑一遍最小（最大）费用流就好辣。</p>
<h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line">#define ll long long</span><br><span class="line">using namespace std;</span><br><span class="line">const ll maxn &#x3D; 1e6;</span><br><span class="line">const ll inf &#x3D; 1e15;</span><br><span class="line">int prime[maxn + 10], check[maxn + 10];</span><br><span class="line">int s, t;</span><br><span class="line">int n, cnt;</span><br><span class="line">void init() &#123;</span><br><span class="line">  memset(check, 0, sizeof(check));</span><br><span class="line">  cnt &#x3D; 0;</span><br><span class="line">  for (int i &#x3D; 2; i &lt;&#x3D; maxn; i++) &#123;</span><br><span class="line">    if (!check[i])</span><br><span class="line">      prime[cnt++] &#x3D; i;</span><br><span class="line">    for (int j &#x3D; 0; j &lt; cnt; j++) &#123;</span><br><span class="line">      if (i * prime[j] &gt; maxn)</span><br><span class="line">        break;</span><br><span class="line">      check[i * prime[j]] &#x3D; true;</span><br><span class="line">      if (i % prime[j] &#x3D;&#x3D; 0)</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">const int N &#x3D; 300;</span><br><span class="line">ll a[N], b[N], c[N];</span><br><span class="line">struct edge &#123;</span><br><span class="line">  int from, to;</span><br><span class="line">  ll cap, flow, cost;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;ll&gt; G[N];</span><br><span class="line">vector&lt;edge&gt; E;</span><br><span class="line">void add_edge(int from, int to, ll cap, ll cost) &#123;</span><br><span class="line">  E.push_back((edge)&#123;from, to, cap, 0, cost&#125;);</span><br><span class="line">  E.push_back((edge)&#123;to, from, 0, 0, -cost&#125;);</span><br><span class="line">  int m &#x3D; E.size();</span><br><span class="line">  G[from].push_back(m - 2);</span><br><span class="line">  G[to].push_back(m - 1);</span><br><span class="line">&#125;</span><br><span class="line">int calc(int x) &#123;</span><br><span class="line">  int ret &#x3D; 0;</span><br><span class="line">  for (int i &#x3D; 0; prime[i] &lt;&#x3D; x; i++) &#123;</span><br><span class="line">    if (x % prime[i] &#x3D;&#x3D; 0) &#123;</span><br><span class="line">      while (x % prime[i] &#x3D;&#x3D; 0 &amp;&amp; x) &#123;</span><br><span class="line">        ret++;</span><br><span class="line">        x &#x2F;&#x3D; prime[i];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return ret;</span><br><span class="line">&#125;</span><br><span class="line">int pre[N];</span><br><span class="line">int inq[N];</span><br><span class="line">ll dist[N];</span><br><span class="line">ll fi[N];</span><br><span class="line">bool spfa(ll &amp;flow, ll &amp;cost) &#123;</span><br><span class="line">  for (int i &#x3D; 0; i &lt;&#x3D; n + 1; i++) &#123;</span><br><span class="line">    dist[i] &#x3D; -inf;</span><br><span class="line">  &#125;</span><br><span class="line">  memset(inq, 0, sizeof(inq));</span><br><span class="line">  dist[s] &#x3D; 0, inq[s] &#x3D; 1, pre[s] &#x3D; 0, fi[s] &#x3D; inf;</span><br><span class="line">  queue&lt;int&gt; q;</span><br><span class="line">  q.push(s);</span><br><span class="line">  while (!q.empty()) &#123;</span><br><span class="line">    int u &#x3D; q.front();</span><br><span class="line">    q.pop();</span><br><span class="line">    inq[u] &#x3D; 0;</span><br><span class="line">    for (int i &#x3D; 0; i &lt; G[u].size(); i++) &#123;</span><br><span class="line">      edge &amp;e &#x3D; E[G[u][i]];</span><br><span class="line">      if (e.cap &gt; e.flow &amp;&amp; dist[e.to] &lt; dist[u] + e.cost) &#123;</span><br><span class="line">        dist[e.to] &#x3D; dist[u] + e.cost;</span><br><span class="line">        pre[e.to] &#x3D; G[u][i];</span><br><span class="line">        fi[e.to] &#x3D; min(fi[u], e.cap - e.flow);</span><br><span class="line">        if (!inq[e.to]) &#123;</span><br><span class="line">          q.push(e.to);</span><br><span class="line">          inq[e.to] &#x3D; 1;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  if (dist[t] &lt;&#x3D; -inf)</span><br><span class="line">    return false;</span><br><span class="line">  if (cost + dist[t] * fi[t] &lt; 0) &#123;</span><br><span class="line">    ll temp &#x3D; cost &#x2F; (-dist[t]); &#x2F;&#x2F;temp:还能够增加的流</span><br><span class="line">    flow +&#x3D; temp;</span><br><span class="line">    return false;</span><br><span class="line">  &#125;</span><br><span class="line">  flow +&#x3D; fi[t];</span><br><span class="line">  cost +&#x3D; dist[t] * fi[t];</span><br><span class="line">  int u &#x3D; t;</span><br><span class="line">  while (u !&#x3D; s) &#123;</span><br><span class="line">    E[pre[u]].flow +&#x3D; fi[t];</span><br><span class="line">    E[pre[u] ^ 1].flow -&#x3D; fi[t];</span><br><span class="line">    u &#x3D; E[pre[u]].from;</span><br><span class="line">  &#125;</span><br><span class="line">  return true;</span><br><span class="line">&#125;</span><br><span class="line">ll mcmf(int s, int t) &#123;</span><br><span class="line">  ll flow &#x3D; 0;</span><br><span class="line">  ll cost &#x3D; 0;</span><br><span class="line">  while (spfa(flow, cost))</span><br><span class="line">    ;</span><br><span class="line">  return flow;</span><br><span class="line">&#125;</span><br><span class="line">int main() &#123;</span><br><span class="line">  init();</span><br><span class="line">  &#x2F;&#x2F;  freopen(&quot;input&quot;, &quot;r&quot;, stdin);</span><br><span class="line">  scanf(&quot;%d&quot;, &amp;n);</span><br><span class="line">  s &#x3D; 0, t &#x3D; n + 1;</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; n; i++)</span><br><span class="line">    scanf(&quot;%lld&quot;, &amp;a[i]);</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; n; i++)</span><br><span class="line">    scanf(&quot;%lld&quot;, &amp;b[i]);</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; n; i++)</span><br><span class="line">    scanf(&quot;%lld&quot;, &amp;c[i]);</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; n; i++) &#123;</span><br><span class="line">    int f1 &#x3D; calc(a[i]), f2;</span><br><span class="line">    for (int j &#x3D; 1; j &lt;&#x3D; n; j++) &#123;</span><br><span class="line">      f2 &#x3D; calc(a[j]);</span><br><span class="line">      if ((f1 % 2 &#x3D;&#x3D; 1) &amp;&amp; ((f2 &#x3D;&#x3D; f1 - 1 &amp;&amp; a[i] % a[j] &#x3D;&#x3D; 0) ||</span><br><span class="line">                            (f1 &#x3D;&#x3D; f2 - 1 &amp;&amp; a[j] % a[i] &#x3D;&#x3D; 0))) &#123;</span><br><span class="line">        add_edge(i, j, inf, c[i] * c[j]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if (f1 % 2 &#x3D;&#x3D; 1)</span><br><span class="line">      add_edge(s, i, b[i], 0);</span><br><span class="line">    else</span><br><span class="line">      add_edge(i, t, b[i], 0);</span><br><span class="line">  &#125;</span><br><span class="line">  ll ans &#x3D; mcmf(s, t);</span><br><span class="line">  printf(&quot;%lld\n&quot;, ans);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="mrmorning.github.io/2017/02/15/bzoj1001-BJOI2006-%E7%8B%BC%E6%8A%93%E5%85%94%E5%AD%90%E2%80%94%E2%80%94%E6%9C%80%E5%A4%A7%E6%B5%81%E8%BD%AC%E6%9C%80%E7%9F%AD%E8%B7%AF%EF%BC%8C%E5%B9%B3%E9%9D%A2%E5%9B%BE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Geng">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chen Geng's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/15/bzoj1001-BJOI2006-%E7%8B%BC%E6%8A%93%E5%85%94%E5%AD%90%E2%80%94%E2%80%94%E6%9C%80%E5%A4%A7%E6%B5%81%E8%BD%AC%E6%9C%80%E7%9F%AD%E8%B7%AF%EF%BC%8C%E5%B9%B3%E9%9D%A2%E5%9B%BE/" class="post-title-link" itemprop="url">[bzoj1001][BJOI2006]狼抓兔子——最大流转最短路，平面图</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-02-15 20:02:00" itemprop="dateCreated datePublished" datetime="2017-02-15T20:02:00+00:00">2017-02-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-02 09:03:59" itemprop="dateModified" datetime="2020-08-02T09:03:59+00:00">2020-08-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="题目描述："><a href="#题目描述：" class="headerlink" title="题目描述："></a>题目描述：</h1><p>给定一个平面图，求最小割。</p>
<h1 id="题解："><a href="#题解：" class="headerlink" title="题解："></a>题解：</h1><p>本题是一道经典题.<br><a target="_blank" rel="noopener" href="http://wenku.baidu.com/link?url=87F10nBWauMdSF-PaKHoG-3fZj0jFE63P6pHSeX6ZiguQqXOQxm41iLWW5IdZCp2MWFQ8JghamfeI68PtLqEv_JSWapGp5z415gNoYb031u">周冬Orz的论文</a>是很好的研究资料。<br>这道题点太多，所以直接跑dinic无疑会超时。<br>我们观察原图，发现原图是一个平面图。<br>什么是平面图呢？平面图就是可以画在平面上，边没有交错的图。<br>平面图有几个很吼的性质：<br>1. 欧拉定理（欧拉的定理真多。。):如果平面图把平面分为f个面，有n个点，m条边，那么我们有：<br>$$f = m - n + 2$$<br>2. 任何一个平面图的对偶图还是一个平面图。</p>
<p>这里的对偶图指的是把原图中的面当作点，边还是边进行构图得到的图。<br>我们很容易发现，对偶图中的一个环就是原图的一个最小割。<br>但是，显然我们求环还是比较麻烦的。<br>我们考察原图性质，<br>如果在st中间连一条新边，显然新图还是平面图，同时会比原图多出一个面，我们称之为副面，<br>对于这个新图，我们构对偶图，同时令副面和最大的面一个为起点，一个为终点，显然对偶图中的最短路就是原图的一个最小割。<br>然后spfa解决就好辣。<br>本题最恶心的点在于建对偶图。</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">const int maxn &#x3D; (1000 * 1000 + 50) * 2;</span><br><span class="line">int n, m, nm, s, t;</span><br><span class="line">int dist[maxn];</span><br><span class="line">struct edge &#123;</span><br><span class="line">  int to, weigh;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;edge&gt; G[maxn];</span><br><span class="line">void add_edge(int from, int to, int weigh) &#123;</span><br><span class="line">  G[from].push_back((edge)&#123;to, weigh&#125;);</span><br><span class="line">  G[to].push_back((edge)&#123;from, weigh&#125;);</span><br><span class="line">&#125;</span><br><span class="line">void spfa() &#123;</span><br><span class="line">  queue&lt;int&gt; q;</span><br><span class="line">  memset(dist, 127, sizeof(dist));</span><br><span class="line">  dist[s] &#x3D; 0;</span><br><span class="line">  q.push(s);</span><br><span class="line">  int inq[maxn];</span><br><span class="line">  memset(inq, 0, sizeof(inq));</span><br><span class="line">  inq[s] &#x3D; 1;</span><br><span class="line">  while (!q.empty()) &#123;</span><br><span class="line">    int u &#x3D; q.front();</span><br><span class="line">    q.pop();</span><br><span class="line">    inq[u] &#x3D; 0;</span><br><span class="line">    for (int i &#x3D; 0; i &lt; G[u].size(); i++) &#123;</span><br><span class="line">      edge &amp;e &#x3D; G[u][i];</span><br><span class="line">      if (dist[e.to] &gt; dist[u] + e.weigh) &#123;</span><br><span class="line">        dist[e.to] &#x3D; dist[u] + e.weigh;</span><br><span class="line">        if (inq[e.to] &#x3D;&#x3D; 0) &#123;</span><br><span class="line">          q.push(e.to);</span><br><span class="line">          inq[e.to] &#x3D; 1;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">int main() &#123;</span><br><span class="line">  scanf(&quot;%d%d&quot;, &amp;n, &amp;m);</span><br><span class="line">  nm &#x3D; (n * m - m - n + 1) &lt;&lt; 1;</span><br><span class="line">  s &#x3D; 0, t &#x3D; nm + 1;</span><br><span class="line">  &#x2F;&#x2F;横向边</span><br><span class="line">  int x;</span><br><span class="line">  for (int j &#x3D; 1; j &lt; m; j++) &#123;</span><br><span class="line">    scanf(&quot;%d&quot;, &amp;x);</span><br><span class="line">    add_edge(j, t, x);</span><br><span class="line">  &#125;</span><br><span class="line">  for (int i &#x3D; 1; i &lt; (n - 1); i++) &#123;</span><br><span class="line">    for (int j &#x3D; 1; j &lt; m; j++) &#123;</span><br><span class="line">      scanf(&quot;%d&quot;, &amp;x);</span><br><span class="line">      add_edge((i &lt;&lt; 1) * (m - 1) + j, ((i &lt;&lt; 1) - 1) * (m - 1) + j, x);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  for (int j &#x3D; 1; j &lt; m; j++) &#123;</span><br><span class="line">    scanf(&quot;%d&quot;, &amp;x);</span><br><span class="line">    add_edge(((n &lt;&lt; 1) - 3) * (m - 1) + j, 0, x);</span><br><span class="line">  &#125;</span><br><span class="line">  &#x2F;&#x2F;纵向边</span><br><span class="line">  for (int i &#x3D; 0; i &lt; n - 1; i++) &#123;</span><br><span class="line">    for (int j &#x3D; 1; j &lt;&#x3D; m; j++) &#123;</span><br><span class="line">      scanf(&quot;%d&quot;, &amp;x);</span><br><span class="line">      if (j &#x3D;&#x3D; 1)</span><br><span class="line">        add_edge(0, (i &lt;&lt; 1) * (m - 1) + m, x);</span><br><span class="line">      else if (j &#x3D;&#x3D; m)</span><br><span class="line">        add_edge((i &lt;&lt; 1 | 1) * (m - 1), t, x);</span><br><span class="line">      else</span><br><span class="line">        add_edge((i &lt;&lt; 1) * (m - 1) + j - 1, (i &lt;&lt; 1) * (m - 1) + j + m - 1, x);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &#x2F;&#x2F;斜</span><br><span class="line">  for (int i &#x3D; 0; i &lt; n - 1; i++) &#123;</span><br><span class="line">    for (int j &#x3D; 1; j &lt; m; j++) &#123;</span><br><span class="line">      scanf(&quot;%d&quot;, &amp;x);</span><br><span class="line">      add_edge((i &lt;&lt; 1 | 1) * (m - 1) + j, (i &lt;&lt; 1) * (m - 1) + j, x);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  spfa();</span><br><span class="line">  printf(&quot;%d&quot;, dist[t]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="mrmorning.github.io/2017/02/15/bzoj1433-ZJOI2009-%E5%81%87%E6%9C%9F%E7%9A%84%E5%AE%BF%E8%88%8D%E2%80%94%E2%80%94%E4%BA%8C%E5%88%86%E5%9B%BE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Geng">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chen Geng's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/15/bzoj1433-ZJOI2009-%E5%81%87%E6%9C%9F%E7%9A%84%E5%AE%BF%E8%88%8D%E2%80%94%E2%80%94%E4%BA%8C%E5%88%86%E5%9B%BE/" class="post-title-link" itemprop="url">[bzoj1433][ZJOI2009]假期的宿舍——二分图</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-02-15 18:57:00" itemprop="dateCreated datePublished" datetime="2017-02-15T18:57:00+00:00">2017-02-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-02 09:03:59" itemprop="dateModified" datetime="2020-08-02T09:03:59+00:00">2020-08-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>#题目大意<br><a target="_blank" rel="noopener" href="http://www.lydsy.com/JudgeOnline/problem.php?id=1433">传送门</a><br>#题解<br>显然是二分图匹配。<br>用一些方法建图就好了。<br>要注意的是：<br><em>本题有多组数据！！！</em><br><em>初始化一定要注意！！！</em></p>
<p>#代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">const int maxn &#x3D; 505;</span><br><span class="line">const int inf &#x3D; 0x3f3f3f;</span><br><span class="line">int n;</span><br><span class="line">&#x2F;&#x2F; 1~n:学生</span><br><span class="line">&#x2F;&#x2F; n+1~n+k:床位</span><br><span class="line">int isbed[maxn], insch[maxn];</span><br><span class="line">int dist[maxn * 2], iter[maxn * 2];</span><br><span class="line">struct edge &#123;</span><br><span class="line">  int to, cap, rev;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;edge&gt; G[maxn];</span><br><span class="line">void add_edge(int from, int to, int cap) &#123;</span><br><span class="line">  G[from].push_back((edge)&#123;to, cap, G[to].size()&#125;);</span><br><span class="line">  G[to].push_back((edge)&#123;from, 0, G[from].size() - 1&#125;);</span><br><span class="line">&#125;</span><br><span class="line">int cnt &#x3D; 0;</span><br><span class="line">void read() &#123;</span><br><span class="line">  scanf(&quot;%d&quot;, &amp;n);</span><br><span class="line">  memset(isbed, 0, sizeof(isbed));</span><br><span class="line">  for (int i &#x3D; 0; i &lt;&#x3D; 2 * n + 1; i++) &#123;</span><br><span class="line">    G[i].clear();</span><br><span class="line">  &#125;</span><br><span class="line">  cnt &#x3D; 0;</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; n; i++) &#123;</span><br><span class="line">    scanf(&quot;%d&quot;, &amp;isbed[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; n; i++) &#123;</span><br><span class="line">    scanf(&quot;%d&quot;, &amp;insch[i]);</span><br><span class="line">    insch[i] &#x3D; insch[i] ^ 1;</span><br><span class="line">  &#125;</span><br><span class="line">  for (int i &#x3D; 1; i &lt;&#x3D; n; i++) &#123;</span><br><span class="line">    if (isbed[i])</span><br><span class="line">      add_edge(i, i + n, 1);</span><br><span class="line">    for (int j &#x3D; 1; j &lt;&#x3D; n; j++) &#123;</span><br><span class="line">      int x;</span><br><span class="line">      scanf(&quot;%d&quot;, &amp;x);</span><br><span class="line">      if (x &amp;&amp; isbed[j]) &#123;</span><br><span class="line">        if (!(isbed[i]) || (isbed[i] &amp;&amp; insch[i])) &#123;</span><br><span class="line">          add_edge(i, n + j, 1);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if (!(isbed[i]) || (isbed[i] &amp;&amp; insch[i])) &#123;</span><br><span class="line">      cnt++;</span><br><span class="line">      add_edge(0, i, 1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (isbed[i])</span><br><span class="line">      add_edge(n + i, 2 * n + 1, 1);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">void bfs(int from) &#123;</span><br><span class="line">  memset(dist, -1, sizeof(dist));</span><br><span class="line">  dist[from] &#x3D; 0;</span><br><span class="line">  queue&lt;int&gt; q;</span><br><span class="line">  q.push(from);</span><br><span class="line">  while (!q.empty()) &#123;</span><br><span class="line">    int u &#x3D; q.front();</span><br><span class="line">    q.pop();</span><br><span class="line">    for (int i &#x3D; 0; i &lt; G[u].size(); i++) &#123;</span><br><span class="line">      edge &amp;e &#x3D; G[u][i];</span><br><span class="line">      if (dist[e.to] &lt; 0 &amp;&amp; e.cap &gt; 0) &#123;</span><br><span class="line">        dist[e.to] &#x3D; dist[u] + 1;</span><br><span class="line">        q.push(e.to);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">int dfs(int from, int to, int f) &#123;</span><br><span class="line">  if (from &#x3D;&#x3D; to)</span><br><span class="line">    return f;</span><br><span class="line">  for (int &amp;i &#x3D; iter[from]; i &lt; G[from].size(); i++) &#123;</span><br><span class="line">    edge &amp;e &#x3D; G[from][i];</span><br><span class="line">    if (e.cap &gt; 0 &amp;&amp; dist[e.to] &gt; dist[from]) &#123;</span><br><span class="line">      int d &#x3D; dfs(e.to, to, min(f, e.cap));</span><br><span class="line">      if (d &gt; 0) &#123;</span><br><span class="line">        e.cap -&#x3D; d;</span><br><span class="line">        G[e.to][e.rev].cap +&#x3D; d;</span><br><span class="line">        return d;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br><span class="line">int max_flow(int from, int to) &#123;</span><br><span class="line">  int flow &#x3D; 0;</span><br><span class="line">  for (;;) &#123;</span><br><span class="line">    bfs(from);</span><br><span class="line">    if (dist[to] &lt; 0)</span><br><span class="line">      return flow;</span><br><span class="line">    memset(iter, 0, sizeof(iter));</span><br><span class="line">    int f;</span><br><span class="line">    while ((f &#x3D; dfs(from, to, inf) &gt; 0))</span><br><span class="line">      flow +&#x3D; f;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">int main() &#123;</span><br><span class="line">  &#x2F;&#x2F;  freopen(&quot;input&quot;, &quot;r&quot;, stdin);</span><br><span class="line">  int T;</span><br><span class="line">  scanf(&quot;%d&quot;, &amp;T);</span><br><span class="line">  while (T--) &#123;</span><br><span class="line">    cnt &#x3D; 0;</span><br><span class="line">    read();</span><br><span class="line">    int ans &#x3D; max_flow(0, 2 * n + 1);</span><br><span class="line">    if (ans &#x3D;&#x3D; cnt)</span><br><span class="line">      printf(&quot;^_^\n&quot;);</span><br><span class="line">    else</span><br><span class="line">      printf(&quot;T_T\n&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="mrmorning.github.io/2017/02/11/bzoj1488-HNOI2009-%E5%9B%BE%E7%9A%84%E5%90%8C%E6%9E%84%E2%80%94%E2%80%94Polya%E5%AE%9A%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Geng">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chen Geng's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/11/bzoj1488-HNOI2009-%E5%9B%BE%E7%9A%84%E5%90%8C%E6%9E%84%E2%80%94%E2%80%94Polya%E5%AE%9A%E7%90%86/" class="post-title-link" itemprop="url">[bzoj1488][HNOI2009]图的同构——Polya定理</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-02-11 22:24:00" itemprop="dateCreated datePublished" datetime="2017-02-11T22:24:00+00:00">2017-02-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-02 09:03:59" itemprop="dateModified" datetime="2020-08-02T09:03:59+00:00">2020-08-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>#题目大意</p>
<blockquote>
<p>求两两互不同构的含n个点的简单图有多少种。<br>简单图是关联一对顶点的无向边不多于一条的不含自环的图。<br>a图与b图被认为是同构的是指a图的顶点经过一定的重新标号以后，a图的顶点集和边集能完全与b图一一对应。</p>
</blockquote>
<p>#题解<br>这个题是学习了Polya定理和群论以后的练手题，但是推了好久并没有推出来。。。。真的是太难辣。。。<br>首先我先说一下我错误的想法：<br>很容易就把这个题转化成了给$K_n$的完全图上的边进行二着色的问题，然后，由于在组合数学课程中经常接触到多边形着色，所以我就把这个题错误的转化成了在一个正$\frac{n(n-1)}{2}$边形的顶点上进行二着色的问题。然而对于n=1,2,3这种方法都是可行的，但是到了n=4的情况，这种方法就不可行了。我仔细观察了一下，发现这个转化<strong>不符合满足纯粹性和完备性</strong>。。。<br>然后就说一下正解吧。<br>首先我们考虑n = 4的情况，对于$K_4$进行二着色，我们很容易发现，由于图是可以任意扭转的，所以它的置换群<strong>实际上是一个对称群</strong>！<br>那么对于点的每一个置换我们要计算对应的边的置换。<br>在一个置换中，考察一条边，如果这条边的两个节点位于相同的<strong>循环</strong>中，那么我们可以得出边的循环个数是点的循环个数的一半。<br>如果这条边的两个节点位于不同的循环中，那么我们画一画图就可以知道如果点的循环个数分别是a, b,那么边的循环个数就是gcd(a,b)。<br>根据这样的方法，我们就可以把点的置换转化为边的置换了。<br>下面的任务就是要枚举置换。<br>如果直接暴力，复杂度很高。<br>我们考虑这样的枚举（回溯）方法：<br>依次考虑每一种阶的循环的个数，然后暴力dfs即可。<br>现在假设我们已经枚举好了一个置换，那么这种置换的个数根据一些基本的排列组合知识，可以知道是：<br>$$\frac{n!}{\prod_{i = 1}^{cnt} Val_i * Num_i !}$$</p>
<blockquote>
<p>稍微解释一下这个式子。除以$Val_i$是因为圆形排列，除以$Num_i$是因为同阶循环的重复排列。</p>
</blockquote>
<p>根据Polya定理，等价类的个数就是：<br>$$l = \frac{1}{N!} * \sum 2^m$$</p>
<p><a target="_blank" rel="noopener" href="http://blog.csdn.net/wzq_qwq/article/details/48035455">参考题解</a></p>
<blockquote>
<p>事实上，这个题还有一个变态的做法：<br>就是上OEIS上查询通项公式。。。。<br>#代码</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line">const int mod &#x3D; 997;</span><br><span class="line">const int maxn &#x3D; 1010;</span><br><span class="line">using namespace std;</span><br><span class="line">int n, cnt, ans;</span><br><span class="line">int two[maxn], factor[maxn], val[maxn], num[maxn];</span><br><span class="line">int pow(int n, int m) &#123;</span><br><span class="line">    int ans &#x3D; 1;</span><br><span class="line">    int b &#x3D; m;</span><br><span class="line">    while(b) &#123;</span><br><span class="line">        if(b &amp; 1) ans &#x3D; (ans * n) % mod;</span><br><span class="line">        b &gt;&gt;&#x3D; 1;</span><br><span class="line">        n &#x3D; (n*n) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    return ans;</span><br><span class="line">&#125;</span><br><span class="line">int inv(int n) &#123;</span><br><span class="line">    return pow(n, mod-2);</span><br><span class="line">&#125;</span><br><span class="line">int gcd(int a, int b) &#123;</span><br><span class="line">    if(b &#x3D;&#x3D; 0) return a;</span><br><span class="line">    else return gcd(b, a%b) % mod;</span><br><span class="line">&#125;</span><br><span class="line">void init() &#123;</span><br><span class="line">    factor[0] &#x3D; factor[1] &#x3D; two[0] &#x3D; 1;</span><br><span class="line">    for(int i &#x3D; 2; i &lt;&#x3D; 1000; i++) &#123;</span><br><span class="line">        factor[i] &#x3D; ((i % mod) * factor[i-1]) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    for(int i &#x3D; 1; i &lt;&#x3D; 1000; i++) &#123;</span><br><span class="line">        two[i] &#x3D; (two[i-1] * 2) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">void dfs(int now_num, int left) &#123;</span><br><span class="line">    if(left &#x3D;&#x3D; 0) &#123;</span><br><span class="line">        int sum1 &#x3D; 0, sum2 &#x3D; 1;</span><br><span class="line">        &#x2F;&#x2F;sum1:这一种置换的循环个数</span><br><span class="line">        &#x2F;&#x2F;sum2:这一种置换的个数</span><br><span class="line">        for(int i &#x3D; 1; i &lt;&#x3D; cnt; i++) &#123;</span><br><span class="line">            sum1 +&#x3D; (num[i] * (num[i] - 1) &#x2F; 2 * val[i]) + (val[i]&#x2F;2 * num[i]); </span><br><span class="line">            &#x2F;&#x2F;前一部分:对于同一种循环中的不同循环的边的处理</span><br><span class="line">            for(int j &#x3D; i + 1; j&lt;&#x3D; cnt; j++) &#123;</span><br><span class="line">                sum1 +&#x3D; num[i] * num[j] * gcd(val[i], val[j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        for(int i &#x3D; 1; i &lt;&#x3D; cnt; i++) &#123;</span><br><span class="line">            sum2 &#x3D; (sum2 * pow(val[i], num[i])%mod*factor[num[i]])%mod;</span><br><span class="line">        &#125;</span><br><span class="line">        sum2 &#x3D; inv(sum2) * factor[n] % mod;</span><br><span class="line">        ans &#x3D; (ans + pow(2, sum1) * sum2 % mod) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    if(now_num &gt; left) return;</span><br><span class="line">    dfs(now_num+1, left);</span><br><span class="line">    &#x2F;&#x2F;这里的dfs放到外面可以降低常数：</span><br><span class="line">    &#x2F;&#x2F;如果放在for循环里面，那么num数组中会多出许多0</span><br><span class="line">    &#x2F;&#x2F;浪费时间。</span><br><span class="line">    for(int i &#x3D; 1; i * now_num &lt;&#x3D; left; i++) &#123;</span><br><span class="line">        val[++cnt] &#x3D; now_num, num[cnt] &#x3D; i;</span><br><span class="line">        dfs(now_num+1, left - i * now_num);</span><br><span class="line">        cnt--; &#x2F;&#x2F;回溯</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">    scanf(&quot;%d&quot;, &amp;n);</span><br><span class="line">    init();</span><br><span class="line">    dfs(1, n);</span><br><span class="line">    ans &#x3D; (ans * inv(factor[n])) % mod;</span><br><span class="line">    printf(&quot;%d&quot;, ans);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="mrmorning.github.io/2017/02/09/%E6%91%B8%E9%B1%BC-2017%E8%8B%B1%E6%89%8D%E8%AE%A1%E5%88%92%E5%86%AC%E4%BB%A4%E8%90%A5%E6%B8%B8%E8%AE%B0-%E5%B7%A5%E5%9D%8A%E4%B8%80%E9%A2%98%E8%A7%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Geng">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chen Geng's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/09/%E6%91%B8%E9%B1%BC-2017%E8%8B%B1%E6%89%8D%E8%AE%A1%E5%88%92%E5%86%AC%E4%BB%A4%E8%90%A5%E6%B8%B8%E8%AE%B0-%E5%B7%A5%E5%9D%8A%E4%B8%80%E9%A2%98%E8%A7%A3/" class="post-title-link" itemprop="url">[摸鱼]2017英才计划冬令营游记+工坊一题解</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-02-09 23:08:00" itemprop="dateCreated datePublished" datetime="2017-02-09T23:08:00+00:00">2017-02-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-02 09:03:59" itemprop="dateModified" datetime="2020-08-02T09:03:59+00:00">2020-08-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>#概述<br>本次冬令营是参加英才计划以来第一次与全国各地的计算机英才见面，感觉非常兴奋，从算法之外也认识到了竞赛以外的世界，开阔了眼界，确立了今后一年的培养目标，成为了寒假中一次非常难得的经历。<br>#Day -1<br>主要收拾了一下东西做了一些出行前的准备，还做了几个bzoj上的算法题，详细内容请见<a href="cnblogs.com/gengchen">我的博客</a>。</p>
<p>#Day 0<br>##报道。<br>报到日。<br>早上五点起来出门赶飞机。<br>中午就到了厦门，吃了点午饭，逛了一会厦门大学就去报道了。<br>##破冰。<br>晚上没有老师，大家都玩的很棒，充分起到了破冰的目的，大家从全国各地而来，之前仅仅在网路上有过些许的交流，这一次是真正的所谓”面基“。<br>我们小组充分展现了$\lambda$符号的各种意义。</p>
<p>#Day 1<br>##餐品<br>厦门大学的饭还是非常好吃，虽然菜有些辣，但是瑕不掩瑜。</p>
<p>##教授的报告——怎样知道你是你<br>这一场报告主要介绍了身份识别技术在当代的发展，其中展现了一些专家做科研的过程值得我们学习。<br>身份识别技术在现代有着非常重要的作用，教授主要介绍了：<br>-指纹识别<br>-瞳孔识别<br>-etc.</p>
<p>##参观SCSC<br>这个研究所主要介绍了点云技术，虽然没有听懂，但是感觉很厉害，听学长说我们的导师陈宝权教授对此领域有涉猎，我不禁动起了下一年的工作就搞这个的念头。<br>具体地说，点云技术就是一种建模技术，在市政工作中有着非常重要的作用。<br>之后我们还体验了VR，虽然感觉还没有家里的暴风魔镜效果好。</p>
<p>##参观美亚柏科<br>参观之前对这个公司并没有多少了解，参观之后感觉这个公司技术还是比较强，好像<del>又红又专</del>？<br>不过里面的一些保密技术还是非常有趣的。</p>
<p>#Day 2<br>今天一天都浸在了工坊之中，把自己的全身心投身于一件事的感觉非常棒。下面我来介绍以下工坊一以及我们团队对于工坊一的工作。<br>##题目<br>机器人寻宝。</p>
<blockquote>
<p>给定一N<em>M矩阵，其中有一些三角形或凸四边形障碍和补充能量的电池。有一机器人从起点(sx,sy)走向终点(tx,ty)，每次可以向上下左右任一方向移动一个单位，消耗一单位能量，若机器人接触电池，则获得电池中储存的能量。在过程中，若机器人走出边界、接触障碍或电量为0则失败。<br>­求一条由起点到终点的路径，使得机器人在达到终点时获得尽可能多的能量值。<br>##题目分析<br><img src="http://images2015.cnblogs.com/blog/890886/201702/890886-20170209224110666-1768101091.png"><br>##对多边形障碍的处理。<br>###方法一：叉乘法<br><img src="http://images2015.cnblogs.com/blog/890886/201702/890886-20170209224159713-1570323205.png"><br><img src="http://images2015.cnblogs.com/blog/890886/201702/890886-20170209224211166-503354153.png"><br><img src="http://images2015.cnblogs.com/blog/890886/201702/890886-20170209224254744-615318019.png"><br><img src="http://images2015.cnblogs.com/blog/890886/201702/890886-20170209224308135-1475531336.png"><br>###方法二：射线法<br>这个方法是课堂上俞教授给我们讲的。<br><img src="http://images2015.cnblogs.com/blog/890886/201702/890886-20170209224324057-1067223572.png"><br>###方法三：面积法<br><img src="http://images2015.cnblogs.com/blog/890886/201702/890886-20170209224522151-1024593793.png"><br>###方法四：转角法<br><img src="http://images2015.cnblogs.com/blog/890886/201702/890886-20170209224600494-42674392.png"><br><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/28416085?sort=created">知乎上的相关资料</a><br><img src="http://images2015.cnblogs.com/blog/890886/201702/890886-20170209225133526-1219222222.png"><br>###方法五：斜率法<br>**</em>很多小组都用的这个方法判多边形，但是很显然这个方法有两个缺点：***<br>-浮点精度误差。在计算机处理图形的时候会有很大的误差。<br>-特殊情况判定。斜率不存在怎么办？<br>综上所述，这个方法毫无优点。<br>##如何初始化<br>简单来讲就是通过bfs来初始化，详细内容可以看我在后边附上的课件。<br>##求解答案<br>###第一种方法：<br>直接暴力辣。我们可以枚举一下就可以辣。<br>###第二种方法：状态压缩动态规划<br>如果前面两个步骤都做到位，那这个题就是模板题辣，您随随便便设计一下状态，转移一下就写出来辣，还是非常好写的。<br>###第三种方法：随机算法<br>这个算法的基础可以说是这次冬令营我们收获最大的地方。<br>开始我和HSZ大佬的意见一样：<br>这是一个NP问题。</p>
</blockquote>
<p>但是经过俞教授的讲解，我们发现可以使用随机算法求解一个近似解，由于随机算法在竞赛中不常用，所以我们都没有进行学习。<br>可以说，开启了一个<em>新世界</em>。</p>
<p>当然这个算法我还是不会，今后一定要找机会学习。</p>
<p>##输出方案<br>方案输出非常简单，直接记录fa数组暴力回溯就好辣。<br>然而却调试了很长时间，发现自己是因为dp中一个条件写错了orz</p>
<p>##总结。<br>这个题是一个综合了许多题目的好题。<br>首先通过这个题我学会了计算几何的初级方法。<br><em>其实计算几何就是计算机图形学中的一个重要部分，通过对他的学习，我感受到了计算机图形学的美感，激励我在今年的培养过程中继续学习计算机图形学的相关知识。</em><br>同时学会了gdb中watch的调试方法，具体来说就是：<br>watch a，观察一个变量，相当于一个断点，当这个变量发生了变化我们就可以停住。<br>具体地，比如说：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for(int i &#x3D; 1; i &lt;&#x3D; n; i++) ;</span><br></pre></td></tr></table></figure>
<p>对于这段代码，如果在gdb中调用命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">watch i &lt; 9</span><br></pre></td></tr></table></figure>
<p>就可以在i等于9的时候停住。<br>非常好用的一个功能。</p>
<p>#Day 3<br>今天进行了工坊的总结，在工坊的总结中，我们锻炼了能力，看到了其他小组的强大，同时对于工坊三非常感兴趣，想回头研究一下AI技术。<br>晚上进行了文艺汇演，我们”SD蒟蒻演唱团“演唱了一首”我的天空——OI版“。<br>下面贴上歌词。</p>
<blockquote>
<p>我的天坑重制版——我的OI<br>词：萌新李庚辰<br>曲：南征北战<br>演唱：山东蒟蒻演唱团<br>在搞这OI ，I wanna say so high<br>再做这套模拟 ，I want new life<br>想要打道AC ， 却跪到了现在<br>再见这个dalao环绕的时代<br>再打一次贪心 骗分失败<br>再做一次动规 数组爆开<br>Now I wanna say<br>HelloHello 我真的好水<br>HelloHello<br>秒开栈和队列<br>再来个暴力求解<br>却还是打不动<br>WA在极限数据中<br>在无尽的黑夜<br>码程序码到吐血<br>但是我还有梦<br>不放弃 不放松<br>在我的天坑<br>来英才计划的各位其实都是大神<br>在CF上不是红名就是橙名<br>随便就能单手切开那动态仙人掌<br>我双膝跪地 看着各位dalao远去/<br>先学完记忆化再学迭代加深搜索<br>却发现还要学图论以及那网络流<br>计算机漫漫长路我们还要走很久<br>但请你相信 我们最终能成功<br>笑谈同余与取膜<br>搞扩展欧几里德<br>虽然现在是蒟蒻<br>慢慢会懂更多<br>树链剖分不会做<br>打个表也能凑合<br>我依然拥有梦<br>一代神犇的梦<br>在我的天空</p>
</blockquote>
<p>#Day 5<br>返程。<br>虽然有不舍，但是这是新一段旅程的开始。</p>
<p>####附录<br>[1]SD蒟蒻队:AngryBirds解题报告<br><a target="_blank" rel="noopener" href="http://pan.baidu.com/s/1pKMkuSF">下载链接</a><br>[2]俞勇教授课件<br><a target="_blank" rel="noopener" href="http://pan.baidu.com/s/1dEXucox">下载链接</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/10/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><span class="page-number current">11</span><a class="page-number" href="/page/12/">12</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/12/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Chen Geng</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">179</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">96</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

      
<script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
<script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
<div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div id="myCanvasContainer" class="widget tagcloud">
        <canvas width="250" height="250" id="resCanvas" style="width:100%">
            <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/2-SAT/" rel="tag">2-SAT</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AC%E8%87%AA%E5%8A%A8%E6%9C%BA/" rel="tag">AC自动机</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BSGS/" rel="tag">BSGS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CDQ%E5%88%86%E6%B2%BB/" rel="tag">CDQ分治</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FFT/" rel="tag">FFT</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/KMP/" rel="tag">KMP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Manacher/" rel="tag">Manacher</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NTT/" rel="tag">NTT</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Polya%E5%AE%9A%E7%90%86/" rel="tag">Polya定理</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Prufer%E7%BC%96%E7%A0%81/" rel="tag">Prufer编码</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/STL/" rel="tag">STL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Trie/" rel="tag">Trie</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dfs%E5%BA%8F%E5%88%97/" rel="tag">dfs序列</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lca/" rel="tag">lca</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lct/" rel="tag">lct</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spfa/" rel="tag">spfa</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/splay/" rel="tag">splay</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%8A%E4%B8%8B%E7%95%8C%E7%BD%91%E7%BB%9C%E6%B5%81/" rel="tag">上下界网络流</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%BB%E5%B8%AD%E6%A0%91/" rel="tag">主席树</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B9%B1%E6%90%9E/" rel="tag">乱搞</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%8C%E5%88%86/" rel="tag">二分</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%8C%E5%88%86%E5%9B%BE/" rel="tag">二分图</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BB%A3%E4%BB%B7%E6%8F%90%E5%89%8D%E8%AE%A1%E7%AE%97/" rel="tag">代价提前计算</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%80%8D%E5%A2%9E/" rel="tag">倍增</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%87%B8%E5%8C%85/" rel="tag">凸包</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%86%E5%9D%97/" rel="tag">分块</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%86%E5%B1%82%E5%9B%BE/" rel="tag">分层图</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%86%E6%95%B0%E8%A7%84%E5%88%92/" rel="tag">分数规划</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8A%A8%E6%80%81%E7%82%B9%E5%88%86%E6%B2%BB/" rel="tag">动态点分治</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" rel="tag">动态规划</a><span class="tag-list-count">20</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%95%E8%B0%83%E6%A0%88/" rel="tag">单调栈</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/" rel="tag">单调队列</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%9A%E5%BC%88%E8%AE%BA/" rel="tag">博弈论</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8E%9F%E6%A0%B9/" rel="tag">原根</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%90%8E%E7%BC%80%E6%95%B0%E7%BB%84/" rel="tag">后缀数组</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA/" rel="tag">后缀自动机</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9B%BE%E8%AE%BA/" rel="tag">图论</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F/" rel="tag">多项式</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A5%BD%E9%A2%98/" rel="tag">好题</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AD%97%E5%85%B8%E5%BA%8F/" rel="tag">字典序</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/" rel="tag">字符串</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%93%88%E5%B8%8C/" rel="tag">字符串哈希</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="tag">学习笔记</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%B9%E6%96%A5%E5%8E%9F%E7%90%86/" rel="tag">容斥原理</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B9%B3%E9%9D%A2%E5%9B%BE/" rel="tag">平面图</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B9%B6%E6%9F%A5%E9%9B%86/" rel="tag">并查集</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B9%BF%E4%B9%89%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA/" rel="tag">广义后缀自动机</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BC%BA%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/" rel="tag">强连通分量</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8B%86%E7%82%B9/" rel="tag">拆点</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8B%AC%E5%8F%B7%E5%BA%8F%E5%88%97/" rel="tag">括号序列</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%90%9C%E7%B4%A2/" rel="tag">搜索</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%91%B8%E9%B1%BC/" rel="tag">摸鱼</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E4%BD%8DDP/" rel="tag">数位DP</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6%E7%9F%A5%E8%AF%86/" rel="tag">数学知识</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">数据结构</a><span class="tag-list-count">37</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E8%AE%BA/" rel="tag">数论</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/" rel="tag">斜率优化</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%80%E5%A4%A7%E6%B5%81/" rel="tag">最大流</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%80%E5%B0%8F%E5%89%B2/" rel="tag">最小割</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%83%E5%80%BC%E7%BA%BF%E6%AE%B5%E6%A0%91/" rel="tag">权值线段树</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%8E%E8%B6%85%E7%BA%BF%E6%AE%B5%E6%A0%91/" rel="tag">李超线段树</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9E%9A%E4%B8%BE/" rel="tag">枚举</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A0%91%E4%B8%8A%E5%80%8D%E5%A2%9E/" rel="tag">树上倍增</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A0%91%E5%A5%97%E6%A0%91/" rel="tag">树套树</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A0%91%E5%BD%A2DP/" rel="tag">树形DP</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A0%91%E5%BD%A2dp/" rel="tag">树形dp</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/" rel="tag">树状数组</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A0%91%E9%93%BE%E5%89%96%E5%88%86/" rel="tag">树链剖分</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A8%A1%E5%9E%8B%E8%BD%AC%E5%8C%96/" rel="tag">模型转化</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A8%A1%E6%9D%BF/" rel="tag">模板</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0/" rel="tag">欧拉函数</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%82%B9%E5%88%86%E6%B2%BB/" rel="tag">点分治</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%89%B9%E6%AE%8A%E6%95%B0%E5%88%97/" rel="tag">特殊数列</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%8A%B6%E5%8E%8BDP/" rel="tag">状压DP</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/" rel="tag">生成函数</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%94%9F%E6%88%90%E6%A0%91/" rel="tag">生成树</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%94%9F%E6%88%90%E6%A0%91%E8%AE%A1%E6%95%B0/" rel="tag">生成树计数</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9F%A9%E9%98%B5%E4%B9%98%E6%B3%95/" rel="tag">矩阵乘法</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9F%A9%E9%98%B5%E6%A0%91%E5%AE%9A%E7%90%86/" rel="tag">矩阵树定理</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/" rel="tag">离散对数</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A6%BB%E7%BA%BF%E5%A4%84%E7%90%86/" rel="tag">离线处理</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E8%A7%84%E5%88%92/" rel="tag">线性规划</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/" rel="tag">线段树</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/" rel="tag">组合数学</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%93%E8%AE%BA%E9%A2%98/" rel="tag">结论题</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/" rel="tag">网络流</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%8E%AB%E9%98%9F%E7%AE%97%E6%B3%95/" rel="tag">莫队算法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%92%9F%E8%92%BB/" rel="tag">蒟蒻</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B4%9F%E7%8E%AF/" rel="tag">负环</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B4%AA%E5%BF%83/" rel="tag">贪心</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B4%B9%E7%94%A8%E6%B5%81/" rel="tag">费用流</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%80%80%E6%B5%81/" rel="tag">退流</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%80%92%E5%BD%92/" rel="tag">递归</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83/" rel="tag">高斯消元</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%AB%98%E7%B2%BE%E5%BA%A6/" rel="tag">高精度</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%BB%98%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" rel="tag">默比乌斯反演</a><span class="tag-list-count">2</span></li></ul>
        </canvas>
    </div>
</div>


    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Chen Geng</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
